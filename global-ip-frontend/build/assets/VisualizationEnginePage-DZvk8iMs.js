import{e as lt,n as Uo,o as Wr,q as _,r as N,k as Gr,u as zn,j as f,s as qr,b as Kr,d as Jr}from"./index-BbdKGyFO.js";import{D as Qr}from"./DashboardHeader-CK3555d_.js";import{N as $e,S as ei}from"./Sidebar-i27tk-Tt.js";import{i as Fe,a as to,b as ti,c as no}from"./string-cKWu9XK9.js";import{T as yn}from"./trending-up-DZgQ1Bwi.js";import{U as ni}from"./users-D5aJHt4s.js";import{C as At}from"./circle-alert-DdFSup5D.js";import{E as oo}from"./eye-off-Dlsw8ufA.js";import{E as so}from"./eye-C4i9w_9f.js";import{D as oi}from"./download-5qXpfTS0.js";import{G as ro}from"./globe-CjcR3HKJ.js";import"./chevron-down-CAl0sHJA.js";import"./search-BeavGINr.js";import"./chart-column-ulK0xHEq.js";import"./file-text-CZhUgEQo.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],ri=lt("chart-no-axes-column-increasing",si);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ai=lt("lightbulb",ii);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],li=lt("maximize-2",ci);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],di=lt("rotate-ccw",ui);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],hi=lt("zoom-in",fi);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],pi=lt("zoom-out",mi);var io=180/Math.PI,wn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wo(e,t,n,o,s,i){var r,a,c;return(r=Math.sqrt(e*e+t*t))&&(e/=r,t/=r),(c=e*n+t*o)&&(n-=e*c,o-=t*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),e*o<t*n&&(e=-e,t=-t,c=-c,r=-r),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*io,skewX:Math.atan(c)*io,scaleX:r,scaleY:a}}var jt;function gi(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wn:Wo(t.a,t.b,t.c,t.d,t.e,t.f)}function xi(e){return e==null||(jt||(jt=document.createElementNS("http://www.w3.org/2000/svg","g")),jt.setAttribute("transform",e),!(e=jt.transform.baseVal.consolidate()))?wn:(e=e.matrix,Wo(e.a,e.b,e.c,e.d,e.e,e.f))}function Go(e,t,n,o){function s(u){return u.length?u.pop()+" ":""}function i(u,l,d,m,p,b){if(u!==d||l!==m){var g=p.push("translate(",null,t,null,n);b.push({i:g-4,x:Fe(u,d)},{i:g-2,x:Fe(l,m)})}else(d||m)&&p.push("translate("+d+t+m+n)}function r(u,l,d,m){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),m.push({i:d.push(s(d)+"rotate(",null,o)-2,x:Fe(u,l)})):l&&d.push(s(d)+"rotate("+l+o)}function a(u,l,d,m){u!==l?m.push({i:d.push(s(d)+"skewX(",null,o)-2,x:Fe(u,l)}):l&&d.push(s(d)+"skewX("+l+o)}function c(u,l,d,m,p,b){if(u!==d||l!==m){var g=p.push(s(p)+"scale(",null,",",null,")");b.push({i:g-4,x:Fe(u,d)},{i:g-2,x:Fe(l,m)})}else(d!==1||m!==1)&&p.push(s(p)+"scale("+d+","+m+")")}return function(u,l){var d=[],m=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,d,m),r(u.rotate,l.rotate,d,m),a(u.skewX,l.skewX,d,m),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,d,m),u=l=null,function(p){for(var b=-1,g=m.length,y;++b<g;)d[(y=m[b]).i]=y.x(p);return d.join("")}}}var yi=Go(gi,"px, ","px)","deg)"),wi=Go(xi,", ",")",")"),bi=1e-12;function ao(e){return((e=Math.exp(e))+1/e)/2}function vi(e){return((e=Math.exp(e))-1/e)/2}function Ni(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ei=(function e(t,n,o){function s(i,r){var a=i[0],c=i[1],u=i[2],l=r[0],d=r[1],m=r[2],p=l-a,b=d-c,g=p*p+b*b,y,x;if(g<bi)x=Math.log(m/u)/t,y=function(I){return[a+I*p,c+I*b,u*Math.exp(t*I*x)]};else{var S=Math.sqrt(g),k=(m*m-u*u+o*g)/(2*u*n*S),w=(m*m-u*u-o*g)/(2*m*n*S),A=Math.log(Math.sqrt(k*k+1)-k),M=Math.log(Math.sqrt(w*w+1)-w);x=(M-A)/t,y=function(I){var V=I*x,T=ao(A),z=u/(n*S)*(T*Ni(t*V+A)-vi(A));return[a+z*p,c+z*b,u*T/ao(t*V+A)]}}return y.duration=x*1e3*t/Math.SQRT2,y}return s.rho=function(i){var r=Math.max(.001,+i),a=r*r,c=a*a;return e(r,a,c)},s})(Math.SQRT2,2,4);function ae(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ae(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var sn={exports:{}},rn={},an={exports:{}},cn={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var co;function Si(){if(co)return cn;co=1;var e=Uo();function t(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,s=e.useEffect,i=e.useLayoutEffect,r=e.useDebugValue;function a(d,m){var p=m(),b=o({inst:{value:p,getSnapshot:m}}),g=b[0].inst,y=b[1];return i(function(){g.value=p,g.getSnapshot=m,c(g)&&y({inst:g})},[d,p,m]),s(function(){return c(g)&&y({inst:g}),d(function(){c(g)&&y({inst:g})})},[d]),r(p),p}function c(d){var m=d.getSnapshot;d=d.value;try{var p=m();return!n(d,p)}catch{return!0}}function u(d,m){return m()}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:a;return cn.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:l,cn}var lo;function _i(){return lo||(lo=1,an.exports=Si()),an.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uo;function Ci(){if(uo)return rn;uo=1;var e=Uo(),t=_i();function n(u,l){return u===l&&(u!==0||1/u===1/l)||u!==u&&l!==l}var o=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,r=e.useEffect,a=e.useMemo,c=e.useDebugValue;return rn.useSyncExternalStoreWithSelector=function(u,l,d,m,p){var b=i(null);if(b.current===null){var g={hasValue:!1,value:null};b.current=g}else g=b.current;b=a(function(){function x(M){if(!S){if(S=!0,k=M,M=m(M),p!==void 0&&g.hasValue){var I=g.value;if(p(I,M))return w=I}return w=M}if(I=w,o(k,M))return I;var V=m(M);return p!==void 0&&p(I,V)?(k=M,I):(k=M,w=V)}var S=!1,k,w,A=d===void 0?null:d;return[function(){return x(l())},A===null?void 0:function(){return x(A())}]},[l,d,m,p]);var y=s(u,b[0],b[1]);return r(function(){g.hasValue=!0,g.value=y},[y]),c(y),y},rn}var fo;function ki(){return fo||(fo=1,sn.exports=Ci()),sn.exports}var Mi=ki();const Ai=Wr(Mi),ji={},ho=e=>{let t;const n=new Set,o=(l,d)=>{const m=typeof l=="function"?l(t):l;if(!Object.is(m,t)){const p=t;t=d??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(b=>b(t,p))}},s=()=>t,c={setState:o,getState:s,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(ji?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,s,c);return c},Ti=e=>e?ho(e):ho,{useDebugValue:$i}=_,{useSyncExternalStoreWithSelector:zi}=Ai,Ii=e=>e;function qo(e,t=Ii,n){const o=zi(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return $i(o),o}const mo=(e,t)=>{const n=Ti(e),o=(s,i=t)=>qo(n,s,i);return Object.assign(o,n),o},Di=(e,t)=>e?mo(e,t):mo;function re(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var Ri={value:()=>{}};function Ut(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Pt(n)}function Pt(e){this._=e}function Pi(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",s=n.indexOf(".");if(s>=0&&(o=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Pt.prototype=Ut.prototype={constructor:Pt,on:function(e,t){var n=this._,o=Pi(e+"",n),s,i=-1,r=o.length;if(arguments.length<2){for(;++i<r;)if((s=(e=o[i]).type)&&(s=Hi(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<r;)if(s=(e=o[i]).type)n[s]=po(n[s],e.name,t);else if(t==null)for(s in n)n[s]=po(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Pt(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),o=0,s,i;o<s;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,s=i.length;o<s;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,i=o.length;s<i;++s)o[s].value.apply(t,n)}};function Hi(e,t){for(var n=0,o=e.length,s;n<o;++n)if((s=e[n]).name===t)return s.value}function po(e,t,n){for(var o=0,s=e.length;o<s;++o)if(e[o].name===t){e[o]=Ri,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var bn="http://www.w3.org/1999/xhtml";const go={svg:"http://www.w3.org/2000/svg",xhtml:bn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),go.hasOwnProperty(t)?{space:go[t],local:e}:e}function Vi(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===bn&&t.documentElement.namespaceURI===bn?t.createElement(e):t.createElementNS(n,e)}}function Oi(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ko(e){var t=Wt(e);return(t.local?Oi:Vi)(t)}function Fi(){}function In(e){return e==null?Fi:function(){return this.querySelector(e)}}function Li(e){typeof e!="function"&&(e=In(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,a=o[s]=new Array(r),c,u,l=0;l<r;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new he(o,this._parents)}function Bi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Yi(){return[]}function Jo(e){return e==null?Yi:function(){return this.querySelectorAll(e)}}function Xi(e){return function(){return Bi(e.apply(this,arguments))}}function Zi(e){typeof e=="function"?e=Xi(e):e=Jo(e);for(var t=this._groups,n=t.length,o=[],s=[],i=0;i<n;++i)for(var r=t[i],a=r.length,c,u=0;u<a;++u)(c=r[u])&&(o.push(e.call(c,c.__data__,u,r)),s.push(c));return new he(o,s)}function Qo(e){return function(){return this.matches(e)}}function es(e){return function(t){return t.matches(e)}}var Ui=Array.prototype.find;function Wi(e){return function(){return Ui.call(this.children,e)}}function Gi(){return this.firstElementChild}function qi(e){return this.select(e==null?Gi:Wi(typeof e=="function"?e:es(e)))}var Ki=Array.prototype.filter;function Ji(){return Array.from(this.children)}function Qi(e){return function(){return Ki.call(this.children,e)}}function ea(e){return this.selectAll(e==null?Ji:Qi(typeof e=="function"?e:es(e)))}function ta(e){typeof e!="function"&&(e=Qo(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,a=o[s]=[],c,u=0;u<r;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new he(o,this._parents)}function ts(e){return new Array(e.length)}function na(){return new he(this._enter||this._groups.map(ts),this._parents)}function Ft(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ft.prototype={constructor:Ft,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function oa(e){return function(){return e}}function sa(e,t,n,o,s,i){for(var r=0,a,c=t.length,u=i.length;r<u;++r)(a=t[r])?(a.__data__=i[r],o[r]=a):n[r]=new Ft(e,i[r]);for(;r<c;++r)(a=t[r])&&(s[r]=a)}function ra(e,t,n,o,s,i,r){var a,c,u=new Map,l=t.length,d=i.length,m=new Array(l),p;for(a=0;a<l;++a)(c=t[a])&&(m[a]=p=r.call(c,c.__data__,a,t)+"",u.has(p)?s[a]=c:u.set(p,c));for(a=0;a<d;++a)p=r.call(e,i[a],a,i)+"",(c=u.get(p))?(o[a]=c,c.__data__=i[a],u.delete(p)):n[a]=new Ft(e,i[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(m[a])===c&&(s[a]=c)}function ia(e){return e.__data__}function aa(e,t){if(!arguments.length)return Array.from(this,ia);var n=t?ra:sa,o=this._parents,s=this._groups;typeof e!="function"&&(e=oa(e));for(var i=s.length,r=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=o[u],d=s[u],m=d.length,p=ca(e.call(l,l&&l.__data__,u,o)),b=p.length,g=a[u]=new Array(b),y=r[u]=new Array(b),x=c[u]=new Array(m);n(l,d,g,y,x,p,t);for(var S=0,k=0,w,A;S<b;++S)if(w=g[S]){for(S>=k&&(k=S+1);!(A=y[k])&&++k<b;);w._next=A||null}}return r=new he(r,o),r._enter=a,r._exit=c,r}function ca(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function la(){return new he(this._exit||this._groups.map(ts),this._parents)}function ua(e,t,n){var o=this.enter(),s=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),o&&s?o.merge(s).order():s}function da(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,s=n.length,i=o.length,r=Math.min(s,i),a=new Array(s),c=0;c<r;++c)for(var u=n[c],l=o[c],d=u.length,m=a[c]=new Array(d),p,b=0;b<d;++b)(p=u[b]||l[b])&&(m[b]=p);for(;c<s;++c)a[c]=n[c];return new he(a,this._parents)}function fa(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],s=o.length-1,i=o[s],r;--s>=0;)(r=o[s])&&(i&&r.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(r,i),i=r);return this}function ha(e){e||(e=ma);function t(d,m){return d&&m?e(d.__data__,m.__data__):!d-!m}for(var n=this._groups,o=n.length,s=new Array(o),i=0;i<o;++i){for(var r=n[i],a=r.length,c=s[i]=new Array(a),u,l=0;l<a;++l)(u=r[l])&&(c[l]=u);c.sort(t)}return new he(s,this._parents).order()}function ma(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function pa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ga(){return Array.from(this)}function xa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],s=0,i=o.length;s<i;++s){var r=o[s];if(r)return r}return null}function ya(){let e=0;for(const t of this)++e;return e}function wa(){return!this.node()}function ba(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var s=t[n],i=0,r=s.length,a;i<r;++i)(a=s[i])&&e.call(a,a.__data__,i,s);return this}function va(e){return function(){this.removeAttribute(e)}}function Na(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ea(e,t){return function(){this.setAttribute(e,t)}}function Sa(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function _a(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ca(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ka(e,t){var n=Wt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Na:va:typeof t=="function"?n.local?Ca:_a:n.local?Sa:Ea)(n,t))}function ns(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ma(e){return function(){this.style.removeProperty(e)}}function Aa(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ja(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Ta(e,t,n){return arguments.length>1?this.each((t==null?Ma:typeof t=="function"?ja:Aa)(e,t,n??"")):it(this.node(),e)}function it(e,t){return e.style.getPropertyValue(t)||ns(e).getComputedStyle(e,null).getPropertyValue(t)}function $a(e){return function(){delete this[e]}}function za(e,t){return function(){this[e]=t}}function Ia(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Da(e,t){return arguments.length>1?this.each((t==null?$a:typeof t=="function"?Ia:za)(e,t)):this.node()[e]}function os(e){return e.trim().split(/^|\s+/)}function Dn(e){return e.classList||new ss(e)}function ss(e){this._node=e,this._names=os(e.getAttribute("class")||"")}ss.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function rs(e,t){for(var n=Dn(e),o=-1,s=t.length;++o<s;)n.add(t[o])}function is(e,t){for(var n=Dn(e),o=-1,s=t.length;++o<s;)n.remove(t[o])}function Ra(e){return function(){rs(this,e)}}function Pa(e){return function(){is(this,e)}}function Ha(e,t){return function(){(t.apply(this,arguments)?rs:is)(this,e)}}function Va(e,t){var n=os(e+"");if(arguments.length<2){for(var o=Dn(this.node()),s=-1,i=n.length;++s<i;)if(!o.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?Ha:t?Ra:Pa)(n,t))}function Oa(){this.textContent=""}function Fa(e){return function(){this.textContent=e}}function La(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Ba(e){return arguments.length?this.each(e==null?Oa:(typeof e=="function"?La:Fa)(e)):this.node().textContent}function Ya(){this.innerHTML=""}function Xa(e){return function(){this.innerHTML=e}}function Za(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ua(e){return arguments.length?this.each(e==null?Ya:(typeof e=="function"?Za:Xa)(e)):this.node().innerHTML}function Wa(){this.nextSibling&&this.parentNode.appendChild(this)}function Ga(){return this.each(Wa)}function qa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ka(){return this.each(qa)}function Ja(e){var t=typeof e=="function"?e:Ko(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Qa(){return null}function ec(e,t){var n=typeof e=="function"?e:Ko(e),o=t==null?Qa:typeof t=="function"?t:In(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function tc(){var e=this.parentNode;e&&e.removeChild(this)}function nc(){return this.each(tc)}function oc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function sc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function rc(e){return this.select(e?sc:oc)}function ic(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ac(e){return function(t){e.call(this,t,this.__data__)}}function cc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function lc(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function uc(e,t,n){return function(){var o=this.__on,s,i=ac(t);if(o){for(var r=0,a=o.length;r<a;++r)if((s=o[r]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(s):this.__on=[s]}}function dc(e,t,n){var o=cc(e+""),s,i=o.length,r;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(s=0,l=a[c];s<i;++s)if((r=o[s]).type===l.type&&r.name===l.name)return l.value}return}for(a=t?uc:lc,s=0;s<i;++s)this.each(a(o[s],t,n));return this}function as(e,t,n){var o=ns(e),s=o.CustomEvent;typeof s=="function"?s=new s(t,n):(s=o.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function fc(e,t){return function(){return as(this,e,t)}}function hc(e,t){return function(){return as(this,e,t.apply(this,arguments))}}function mc(e,t){return this.each((typeof t=="function"?hc:fc)(e,t))}function*pc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],s=0,i=o.length,r;s<i;++s)(r=o[s])&&(yield r)}var cs=[null];function he(e,t){this._groups=e,this._parents=t}function kt(){return new he([[document.documentElement]],cs)}function gc(){return this}he.prototype=kt.prototype={constructor:he,select:Li,selectAll:Zi,selectChild:qi,selectChildren:ea,filter:ta,data:aa,enter:na,exit:la,join:ua,merge:da,selection:gc,order:fa,sort:ha,call:pa,nodes:ga,node:xa,size:ya,empty:wa,each:ba,attr:ka,style:Ta,property:Da,classed:Va,text:Ba,html:Ua,raise:Ga,lower:Ka,append:Ja,insert:ec,remove:nc,clone:rc,datum:ic,on:dc,dispatch:mc,[Symbol.iterator]:pc};function me(e){return typeof e=="string"?new he([[document.querySelector(e)]],[document.documentElement]):new he([[e]],cs)}function xc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xe(e,t){if(e=xc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const yc={passive:!1},vt={capture:!0,passive:!1};function ln(e){e.stopImmediatePropagation()}function st(e){e.preventDefault(),e.stopImmediatePropagation()}function ls(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",st,vt);"onselectstart"in t?n.on("selectstart.drag",st,vt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function us(e,t){var n=e.document.documentElement,o=me(e).on("dragstart.drag",null);t&&(o.on("click.drag",st,vt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Tt=e=>()=>e;function vn(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:i,x:r,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}vn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function wc(e){return!e.ctrlKey&&!e.button}function bc(){return this.parentNode}function vc(e,t){return t??{x:e.x,y:e.y}}function Nc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ec(){var e=wc,t=bc,n=vc,o=Nc,s={},i=Ut("start","drag","end"),r=0,a,c,u,l,d=0;function m(w){w.on("mousedown.drag",p).filter(o).on("touchstart.drag",y).on("touchmove.drag",x,yc).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(w,A){if(!(l||!e.call(this,w,A))){var M=k(this,t.call(this,w,A),w,A,"mouse");M&&(me(w.view).on("mousemove.drag",b,vt).on("mouseup.drag",g,vt),ls(w.view),ln(w),u=!1,a=w.clientX,c=w.clientY,M("start",w))}}function b(w){if(st(w),!u){var A=w.clientX-a,M=w.clientY-c;u=A*A+M*M>d}s.mouse("drag",w)}function g(w){me(w.view).on("mousemove.drag mouseup.drag",null),us(w.view,u),st(w),s.mouse("end",w)}function y(w,A){if(e.call(this,w,A)){var M=w.changedTouches,I=t.call(this,w,A),V=M.length,T,z;for(T=0;T<V;++T)(z=k(this,I,w,A,M[T].identifier,M[T]))&&(ln(w),z("start",w,M[T]))}}function x(w){var A=w.changedTouches,M=A.length,I,V;for(I=0;I<M;++I)(V=s[A[I].identifier])&&(st(w),V("drag",w,A[I]))}function S(w){var A=w.changedTouches,M=A.length,I,V;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),I=0;I<M;++I)(V=s[A[I].identifier])&&(ln(w),V("end",w,A[I]))}function k(w,A,M,I,V,T){var z=i.copy(),H=xe(T||M,A),F,P,h;if((h=n.call(w,new vn("beforestart",{sourceEvent:M,target:m,identifier:V,active:r,x:H[0],y:H[1],dx:0,dy:0,dispatch:z}),I))!=null)return F=h.x-H[0]||0,P=h.y-H[1]||0,function C(v,j,R){var E=H,$;switch(v){case"start":s[V]=C,$=r++;break;case"end":delete s[V],--r;case"drag":H=xe(R||j,A),$=r;break}z.call(v,w,new vn(v,{sourceEvent:j,subject:h,target:m,identifier:V,active:$,x:H[0]+F,y:H[1]+P,dx:H[0]-E[0],dy:H[1]-E[1],dispatch:z}),I)}}return m.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Tt(!!w),m):e},m.container=function(w){return arguments.length?(t=typeof w=="function"?w:Tt(w),m):t},m.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Tt(w),m):n},m.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:Tt(!!w),m):o},m.on=function(){var w=i.on.apply(i,arguments);return w===i?m:w},m.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,m):Math.sqrt(d)},m}var at=0,yt=0,ht=0,ds=1e3,Lt,wt,Bt=0,Xe=0,Gt=0,Nt=typeof performance=="object"&&performance.now?performance:Date,fs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Rn(){return Xe||(fs(Sc),Xe=Nt.now()+Gt)}function Sc(){Xe=0}function Yt(){this._call=this._time=this._next=null}Yt.prototype=hs.prototype={constructor:Yt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Rn():+n)+(t==null?0:+t),!this._next&&wt!==this&&(wt?wt._next=this:Lt=this,wt=this),this._call=e,this._time=n,Nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nn())}};function hs(e,t,n){var o=new Yt;return o.restart(e,t,n),o}function _c(){Rn(),++at;for(var e=Lt,t;e;)(t=Xe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--at}function xo(){Xe=(Bt=Nt.now())+Gt,at=yt=0;try{_c()}finally{at=0,kc(),Xe=0}}function Cc(){var e=Nt.now(),t=e-Bt;t>ds&&(Gt-=t,Bt=e)}function kc(){for(var e,t=Lt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Lt=n);wt=e,Nn(o)}function Nn(e){if(!at){yt&&(yt=clearTimeout(yt));var t=e-Xe;t>24?(e<1/0&&(yt=setTimeout(xo,e-Nt.now()-Gt)),ht&&(ht=clearInterval(ht))):(ht||(Bt=Nt.now(),ht=setInterval(Cc,ds)),at=1,fs(xo))}}function yo(e,t,n){var o=new Yt;return t=t==null?0:+t,o.restart(s=>{o.stop(),e(s+t)},t,n),o}var Mc=Ut("start","end","cancel","interrupt"),Ac=[],ms=0,wo=1,En=2,Ht=3,bo=4,Sn=5,Vt=6;function qt(e,t,n,o,s,i){var r=e.__transition;if(!r)e.__transition={};else if(n in r)return;jc(e,n,{name:t,index:o,group:s,on:Mc,tween:Ac,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:ms})}function Pn(e,t){var n=ye(e,t);if(n.state>ms)throw new Error("too late; already scheduled");return n}function ve(e,t){var n=ye(e,t);if(n.state>Ht)throw new Error("too late; already running");return n}function ye(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function jc(e,t,n){var o=e.__transition,s;o[t]=n,n.timer=hs(i,0,n.time);function i(u){n.state=wo,n.timer.restart(r,n.delay,n.time),n.delay<=u&&r(u-n.delay)}function r(u){var l,d,m,p;if(n.state!==wo)return c();for(l in o)if(p=o[l],p.name===n.name){if(p.state===Ht)return yo(r);p.state===bo?(p.state=Vt,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[l]):+l<t&&(p.state=Vt,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[l])}if(yo(function(){n.state===Ht&&(n.state=bo,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=En,n.on.call("start",e,e.__data__,n.index,n.group),n.state===En){for(n.state=Ht,s=new Array(m=n.tween.length),l=0,d=-1;l<m;++l)(p=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=p);s.length=d+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Sn,1),d=-1,m=s.length;++d<m;)s[d].call(e,l);n.state===Sn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Vt,n.timer.stop(),delete o[t];for(var u in o)return;delete e.__transition}}function Ot(e,t){var n=e.__transition,o,s,i=!0,r;if(n){t=t==null?null:t+"";for(r in n){if((o=n[r]).name!==t){i=!1;continue}s=o.state>En&&o.state<Sn,o.state=Vt,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[r]}i&&delete e.__transition}}function Tc(e){return this.each(function(){Ot(this,e)})}function $c(e,t){var n,o;return function(){var s=ve(this,e),i=s.tween;if(i!==n){o=n=i;for(var r=0,a=o.length;r<a;++r)if(o[r].name===t){o=o.slice(),o.splice(r,1);break}}s.tween=o}}function zc(e,t,n){var o,s;if(typeof n!="function")throw new Error;return function(){var i=ve(this,e),r=i.tween;if(r!==o){s=(o=r).slice();for(var a={name:t,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=a;break}c===u&&s.push(a)}i.tween=s}}function Ic(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ye(this.node(),n).tween,s=0,i=o.length,r;s<i;++s)if((r=o[s]).name===e)return r.value;return null}return this.each((t==null?$c:zc)(n,e,t))}function Hn(e,t,n){var o=e._id;return e.each(function(){var s=ve(this,o);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return ye(s,o).value[t]}}function ps(e,t){var n;return(typeof t=="number"?Fe:t instanceof no?to:(n=no(t))?(t=n,to):ti)(e,t)}function Dc(e){return function(){this.removeAttribute(e)}}function Rc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pc(e,t,n){var o,s=n+"",i;return function(){var r=this.getAttribute(e);return r===s?null:r===o?i:i=t(o=r,n)}}function Hc(e,t,n){var o,s=n+"",i;return function(){var r=this.getAttributeNS(e.space,e.local);return r===s?null:r===o?i:i=t(o=r,n)}}function Vc(e,t,n){var o,s,i;return function(){var r,a=n(this),c;return a==null?void this.removeAttribute(e):(r=this.getAttribute(e),c=a+"",r===c?null:r===o&&c===s?i:(s=c,i=t(o=r,a)))}}function Oc(e,t,n){var o,s,i;return function(){var r,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(r=this.getAttributeNS(e.space,e.local),c=a+"",r===c?null:r===o&&c===s?i:(s=c,i=t(o=r,a)))}}function Fc(e,t){var n=Wt(e),o=n==="transform"?wi:ps;return this.attrTween(e,typeof t=="function"?(n.local?Oc:Vc)(n,o,Hn(this,"attr."+e,t)):t==null?(n.local?Rc:Dc)(n):(n.local?Hc:Pc)(n,o,t))}function Lc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Bc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Yc(e,t){var n,o;function s(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Bc(e,i)),n}return s._value=t,s}function Xc(e,t){var n,o;function s(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Lc(e,i)),n}return s._value=t,s}function Zc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Wt(e);return this.tween(n,(o.local?Yc:Xc)(o,t))}function Uc(e,t){return function(){Pn(this,e).delay=+t.apply(this,arguments)}}function Wc(e,t){return t=+t,function(){Pn(this,e).delay=t}}function Gc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Uc:Wc)(t,e)):ye(this.node(),t).delay}function qc(e,t){return function(){ve(this,e).duration=+t.apply(this,arguments)}}function Kc(e,t){return t=+t,function(){ve(this,e).duration=t}}function Jc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?qc:Kc)(t,e)):ye(this.node(),t).duration}function Qc(e,t){if(typeof t!="function")throw new Error;return function(){ve(this,e).ease=t}}function el(e){var t=this._id;return arguments.length?this.each(Qc(t,e)):ye(this.node(),t).ease}function tl(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ve(this,e).ease=n}}function nl(e){if(typeof e!="function")throw new Error;return this.each(tl(this._id,e))}function ol(e){typeof e!="function"&&(e=Qo(e));for(var t=this._groups,n=t.length,o=new Array(n),s=0;s<n;++s)for(var i=t[s],r=i.length,a=o[s]=[],c,u=0;u<r;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new Me(o,this._parents,this._name,this._id)}function sl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,s=n.length,i=Math.min(o,s),r=new Array(o),a=0;a<i;++a)for(var c=t[a],u=n[a],l=c.length,d=r[a]=new Array(l),m,p=0;p<l;++p)(m=c[p]||u[p])&&(d[p]=m);for(;a<o;++a)r[a]=t[a];return new Me(r,this._parents,this._name,this._id)}function rl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function il(e,t,n){var o,s,i=rl(t)?Pn:ve;return function(){var r=i(this,e),a=r.on;a!==o&&(s=(o=a).copy()).on(t,n),r.on=s}}function al(e,t){var n=this._id;return arguments.length<2?ye(this.node(),n).on.on(e):this.each(il(n,e,t))}function cl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ll(){return this.on("end.remove",cl(this._id))}function ul(e){var t=this._name,n=this._id;typeof e!="function"&&(e=In(e));for(var o=this._groups,s=o.length,i=new Array(s),r=0;r<s;++r)for(var a=o[r],c=a.length,u=i[r]=new Array(c),l,d,m=0;m<c;++m)(l=a[m])&&(d=e.call(l,l.__data__,m,a))&&("__data__"in l&&(d.__data__=l.__data__),u[m]=d,qt(u[m],t,n,m,u,ye(l,n)));return new Me(i,this._parents,t,n)}function dl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Jo(e));for(var o=this._groups,s=o.length,i=[],r=[],a=0;a<s;++a)for(var c=o[a],u=c.length,l,d=0;d<u;++d)if(l=c[d]){for(var m=e.call(l,l.__data__,d,c),p,b=ye(l,n),g=0,y=m.length;g<y;++g)(p=m[g])&&qt(p,t,n,g,m,b);i.push(m),r.push(l)}return new Me(i,r,t,n)}var fl=kt.prototype.constructor;function hl(){return new fl(this._groups,this._parents)}function ml(e,t){var n,o,s;return function(){var i=it(this,e),r=(this.style.removeProperty(e),it(this,e));return i===r?null:i===n&&r===o?s:s=t(n=i,o=r)}}function gs(e){return function(){this.style.removeProperty(e)}}function pl(e,t,n){var o,s=n+"",i;return function(){var r=it(this,e);return r===s?null:r===o?i:i=t(o=r,n)}}function gl(e,t,n){var o,s,i;return function(){var r=it(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),it(this,e))),r===c?null:r===o&&c===s?i:(s=c,i=t(o=r,a))}}function xl(e,t){var n,o,s,i="style."+t,r="end."+i,a;return function(){var c=ve(this,e),u=c.on,l=c.value[i]==null?a||(a=gs(t)):void 0;(u!==n||s!==l)&&(o=(n=u).copy()).on(r,s=l),c.on=o}}function yl(e,t,n){var o=(e+="")=="transform"?yi:ps;return t==null?this.styleTween(e,ml(e,o)).on("end.style."+e,gs(e)):typeof t=="function"?this.styleTween(e,gl(e,o,Hn(this,"style."+e,t))).each(xl(this._id,e)):this.styleTween(e,pl(e,o,t),n).on("end.style."+e,null)}function wl(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function bl(e,t,n){var o,s;function i(){var r=t.apply(this,arguments);return r!==s&&(o=(s=r)&&wl(e,r,n)),o}return i._value=t,i}function vl(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,bl(e,t,n??""))}function Nl(e){return function(){this.textContent=e}}function El(e){return function(){var t=e(this);this.textContent=t??""}}function Sl(e){return this.tween("text",typeof e=="function"?El(Hn(this,"text",e)):Nl(e==null?"":e+""))}function _l(e){return function(t){this.textContent=e.call(this,t)}}function Cl(e){var t,n;function o(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&_l(s)),t}return o._value=e,o}function kl(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Cl(e))}function Ml(){for(var e=this._name,t=this._id,n=xs(),o=this._groups,s=o.length,i=0;i<s;++i)for(var r=o[i],a=r.length,c,u=0;u<a;++u)if(c=r[u]){var l=ye(c,t);qt(c,e,n,u,r,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Me(o,this._parents,e,n)}function Al(){var e,t,n=this,o=n._id,s=n.size();return new Promise(function(i,r){var a={value:r},c={value:function(){--s===0&&i()}};n.each(function(){var u=ve(this,o),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),s===0&&i()})}var jl=0;function Me(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function xs(){return++jl}var Se=kt.prototype;Me.prototype={constructor:Me,select:ul,selectAll:dl,selectChild:Se.selectChild,selectChildren:Se.selectChildren,filter:ol,merge:sl,selection:hl,transition:Ml,call:Se.call,nodes:Se.nodes,node:Se.node,size:Se.size,empty:Se.empty,each:Se.each,on:al,attr:Fc,attrTween:Zc,style:yl,styleTween:vl,text:Sl,textTween:kl,remove:ll,tween:Ic,delay:Gc,duration:Jc,ease:el,easeVarying:nl,end:Al,[Symbol.iterator]:Se[Symbol.iterator]};function Tl(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var $l={time:null,delay:0,duration:250,ease:Tl};function zl(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Il(e){var t,n;e instanceof Me?(t=e._id,e=e._name):(t=xs(),(n=$l).time=Rn(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,i=0;i<s;++i)for(var r=o[i],a=r.length,c,u=0;u<a;++u)(c=r[u])&&qt(c,e,t,u,r,n||zl(c,t));return new Me(o,this._parents,e,t)}kt.prototype.interrupt=Tc;kt.prototype.transition=Il;const $t=e=>()=>e;function Dl(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Ce(e,t,n){this.k=e,this.x=t,this.y=n}Ce.prototype={constructor:Ce,scale:function(e){return e===1?this:new Ce(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ce(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ke=new Ce(1,0,0);Ce.prototype;function un(e){e.stopImmediatePropagation()}function mt(e){e.preventDefault(),e.stopImmediatePropagation()}function Rl(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Pl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function vo(){return this.__zoom||ke}function Hl(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Vl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ol(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],r=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r))}function ys(){var e=Rl,t=Pl,n=Ol,o=Hl,s=Vl,i=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Ei,u=Ut("start","zoom","end"),l,d,m,p=500,b=150,g=0,y=10;function x(h){h.property("__zoom",vo).on("wheel.zoom",V,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",z).filter(s).on("touchstart.zoom",H).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(h,C,v,j){var R=h.selection?h.selection():h;R.property("__zoom",vo),h!==R?A(h,C,v,j):R.interrupt().each(function(){M(this,arguments).event(j).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},x.scaleBy=function(h,C,v,j){x.scaleTo(h,function(){var R=this.__zoom.k,E=typeof C=="function"?C.apply(this,arguments):C;return R*E},v,j)},x.scaleTo=function(h,C,v,j){x.transform(h,function(){var R=t.apply(this,arguments),E=this.__zoom,$=v==null?w(R):typeof v=="function"?v.apply(this,arguments):v,D=E.invert($),O=typeof C=="function"?C.apply(this,arguments):C;return n(k(S(E,O),$,D),R,r)},v,j)},x.translateBy=function(h,C,v,j){x.transform(h,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof v=="function"?v.apply(this,arguments):v),t.apply(this,arguments),r)},null,j)},x.translateTo=function(h,C,v,j,R){x.transform(h,function(){var E=t.apply(this,arguments),$=this.__zoom,D=j==null?w(E):typeof j=="function"?j.apply(this,arguments):j;return n(ke.translate(D[0],D[1]).scale($.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof v=="function"?-v.apply(this,arguments):-v),E,r)},j,R)};function S(h,C){return C=Math.max(i[0],Math.min(i[1],C)),C===h.k?h:new Ce(C,h.x,h.y)}function k(h,C,v){var j=C[0]-v[0]*h.k,R=C[1]-v[1]*h.k;return j===h.x&&R===h.y?h:new Ce(h.k,j,R)}function w(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function A(h,C,v,j){h.on("start.zoom",function(){M(this,arguments).event(j).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(j).end()}).tween("zoom",function(){var R=this,E=arguments,$=M(R,E).event(j),D=t.apply(R,E),O=v==null?w(D):typeof v=="function"?v.apply(R,E):v,B=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),L=R.__zoom,Z=typeof C=="function"?C.apply(R,E):C,U=c(L.invert(O).concat(B/L.k),Z.invert(O).concat(B/Z.k));return function(G){if(G===1)G=Z;else{var J=U(G),K=B/J[2];G=new Ce(K,O[0]-J[0]*K,O[1]-J[1]*K)}$.zoom(null,G)}})}function M(h,C,v){return!v&&h.__zooming||new I(h,C)}function I(h,C){this.that=h,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(h,C),this.taps=0}I.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,C){return this.mouse&&h!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var C=me(this.that).datum();u.call(h,this.that,new Dl(h,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:u}),C)}};function V(h,...C){if(!e.apply(this,arguments))return;var v=M(this,C).event(h),j=this.__zoom,R=Math.max(i[0],Math.min(i[1],j.k*Math.pow(2,o.apply(this,arguments)))),E=xe(h);if(v.wheel)(v.mouse[0][0]!==E[0]||v.mouse[0][1]!==E[1])&&(v.mouse[1]=j.invert(v.mouse[0]=E)),clearTimeout(v.wheel);else{if(j.k===R)return;v.mouse=[E,j.invert(E)],Ot(this),v.start()}mt(h),v.wheel=setTimeout($,b),v.zoom("mouse",n(k(S(j,R),v.mouse[0],v.mouse[1]),v.extent,r));function $(){v.wheel=null,v.end()}}function T(h,...C){if(m||!e.apply(this,arguments))return;var v=h.currentTarget,j=M(this,C,!0).event(h),R=me(h.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",B,!0),E=xe(h,v),$=h.clientX,D=h.clientY;ls(h.view),un(h),j.mouse=[E,this.__zoom.invert(E)],Ot(this),j.start();function O(L){if(mt(L),!j.moved){var Z=L.clientX-$,U=L.clientY-D;j.moved=Z*Z+U*U>g}j.event(L).zoom("mouse",n(k(j.that.__zoom,j.mouse[0]=xe(L,v),j.mouse[1]),j.extent,r))}function B(L){R.on("mousemove.zoom mouseup.zoom",null),us(L.view,j.moved),mt(L),j.event(L).end()}}function z(h,...C){if(e.apply(this,arguments)){var v=this.__zoom,j=xe(h.changedTouches?h.changedTouches[0]:h,this),R=v.invert(j),E=v.k*(h.shiftKey?.5:2),$=n(k(S(v,E),j,R),t.apply(this,C),r);mt(h),a>0?me(this).transition().duration(a).call(A,$,j,h):me(this).call(x.transform,$,j,h)}}function H(h,...C){if(e.apply(this,arguments)){var v=h.touches,j=v.length,R=M(this,C,h.changedTouches.length===j).event(h),E,$,D,O;for(un(h),$=0;$<j;++$)D=v[$],O=xe(D,this),O=[O,this.__zoom.invert(O),D.identifier],R.touch0?!R.touch1&&R.touch0[2]!==O[2]&&(R.touch1=O,R.taps=0):(R.touch0=O,E=!0,R.taps=1+!!l);l&&(l=clearTimeout(l)),E&&(R.taps<2&&(d=O[0],l=setTimeout(function(){l=null},p)),Ot(this),R.start())}}function F(h,...C){if(this.__zooming){var v=M(this,C).event(h),j=h.changedTouches,R=j.length,E,$,D,O;for(mt(h),E=0;E<R;++E)$=j[E],D=xe($,this),v.touch0&&v.touch0[2]===$.identifier?v.touch0[0]=D:v.touch1&&v.touch1[2]===$.identifier&&(v.touch1[0]=D);if($=v.that.__zoom,v.touch1){var B=v.touch0[0],L=v.touch0[1],Z=v.touch1[0],U=v.touch1[1],G=(G=Z[0]-B[0])*G+(G=Z[1]-B[1])*G,J=(J=U[0]-L[0])*J+(J=U[1]-L[1])*J;$=S($,Math.sqrt(G/J)),D=[(B[0]+Z[0])/2,(B[1]+Z[1])/2],O=[(L[0]+U[0])/2,(L[1]+U[1])/2]}else if(v.touch0)D=v.touch0[0],O=v.touch0[1];else return;v.zoom("touch",n(k($,D,O),v.extent,r))}}function P(h,...C){if(this.__zooming){var v=M(this,C).event(h),j=h.changedTouches,R=j.length,E,$;for(un(h),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),E=0;E<R;++E)$=j[E],v.touch0&&v.touch0[2]===$.identifier?delete v.touch0:v.touch1&&v.touch1[2]===$.identifier&&delete v.touch1;if(v.touch1&&!v.touch0&&(v.touch0=v.touch1,delete v.touch1),v.touch0)v.touch0[1]=this.__zoom.invert(v.touch0[0]);else if(v.end(),v.taps===2&&($=xe($,this),Math.hypot(d[0]-$[0],d[1]-$[1])<y)){var D=me(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return x.wheelDelta=function(h){return arguments.length?(o=typeof h=="function"?h:$t(+h),x):o},x.filter=function(h){return arguments.length?(e=typeof h=="function"?h:$t(!!h),x):e},x.touchable=function(h){return arguments.length?(s=typeof h=="function"?h:$t(!!h),x):s},x.extent=function(h){return arguments.length?(t=typeof h=="function"?h:$t([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),x):t},x.scaleExtent=function(h){return arguments.length?(i[0]=+h[0],i[1]=+h[1],x):[i[0],i[1]]},x.translateExtent=function(h){return arguments.length?(r[0][0]=+h[0][0],r[1][0]=+h[1][0],r[0][1]=+h[0][1],r[1][1]=+h[1][1],x):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},x.constrain=function(h){return arguments.length?(n=h,x):n},x.duration=function(h){return arguments.length?(a=+h,x):a},x.interpolate=function(h){return arguments.length?(c=h,x):c},x.on=function(){var h=u.on.apply(u,arguments);return h===u?x:h},x.clickDistance=function(h){return arguments.length?(g=(h=+h)*h,x):Math.sqrt(g)},x.tapDistance=function(h){return arguments.length?(y=+h,x):y},x}const Kt=N.createContext(null),Fl=Kt.Provider,Ae={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},ws=Ae.error001();function ee(e,t){const n=N.useContext(Kt);if(n===null)throw new Error(ws);return qo(n,e,t)}const se=()=>{const e=N.useContext(Kt);if(e===null)throw new Error(ws);return N.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ll=e=>e.userSelectionActive?"none":"all";function Vn({position:e,children:t,className:n,style:o,...s}){const i=ee(Ll),r=`${e}`.split("-");return _.createElement("div",{className:ae(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function Bl({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:_.createElement(Vn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},_.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Yl=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const d=N.useRef(null),[m,p]=N.useState({x:0,y:0,width:0,height:0}),b=ae(["react-flow__edge-textwrapper",u]);return N.useEffect(()=>{if(d.current){const g=d.current.getBBox();p({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:_.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:b,visibility:m.width?"visible":"hidden",...l},s&&_.createElement("rect",{width:m.width+2*r[0],x:-r[0],y:-r[1],height:m.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),_.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:d,style:o},n),c)};var Xl=N.memo(Yl);const On=e=>({width:e.offsetWidth,height:e.offsetHeight}),ct=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fn=(e={x:0,y:0},t)=>({x:ct(e.x,t[0][0],t[1][0]),y:ct(e.y,t[0][1],t[1][1])}),No=(e,t,n)=>e<t?ct(Math.abs(e-t),1,50)/50:e>n?-ct(Math.abs(e-n),1,50)/50:0,bs=(e,t)=>{const n=No(e.x,35,t.width-35)*20,o=No(e.y,35,t.height-35)*20;return[n,o]},vs=e=>e.getRootNode?.()||window?.document,Ns=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Et=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Es=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Eo=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Zl=(e,t)=>Es(Ns(Et(e),Et(t))),_n=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Ul=e=>pe(e.width)&&pe(e.height)&&pe(e.x)&&pe(e.y),pe=e=>!isNaN(e)&&isFinite(e),te=Symbol.for("internals"),Ss=["Enter"," ","Escape"],Wl=(e,t)=>{},Gl=e=>"nativeEvent"in e;function Cn(e){const n=(Gl(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const _s=e=>"clientX"in e,Ie=(e,t)=>{const n=_s(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},Xt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,Mt=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:m,interactionWidth:p=20})=>_.createElement(_.Fragment,null,_.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:m}),p&&_.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),s&&pe(n)&&pe(o)?_.createElement(Xl,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Mt.displayName="BaseEdge";function pt(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function Cs({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,a=o<t?o+r:o-r;return[i,a,s,r]}function ks({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:a}){const c=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+a*.375+o*.125,l=Math.abs(c-e),d=Math.abs(u-t);return[c,u,l,d]}var Ze;(function(e){e.Strict="strict",e.Loose="loose"})(Ze||(Ze={}));var Be;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Be||(Be={}));var St;(function(e){e.Partial="partial",e.Full="full"})(St||(St={}));var _e;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(_e||(_e={}));var _t;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(_t||(_t={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));function So({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===Y.Left||e===Y.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Ms({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top}){const[r,a]=So({pos:n,x1:e,y1:t,x2:o,y2:s}),[c,u]=So({pos:i,x1:o,y1:s,x2:e,y2:t}),[l,d,m,p]=ks({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${r},${a} ${c},${u} ${o},${s}`,l,d,m,p]}const Ln=N.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=Y.Bottom,targetPosition:i=Y.Top,label:r,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:m,markerEnd:p,markerStart:b,interactionWidth:g})=>{const[y,x,S]=Ms({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return _.createElement(Mt,{path:y,labelX:x,labelY:S,label:r,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:m,markerEnd:p,markerStart:b,interactionWidth:g})});Ln.displayName="SimpleBezierEdge";const _o={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},ql=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Co=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Kl({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:o=Y.Top,center:s,offset:i}){const r=_o[t],a=_o[o],c={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},l=ql({source:c,sourcePosition:t,target:u}),d=l.x!==0?"x":"y",m=l[d];let p=[],b,g;const y={x:0,y:0},x={x:0,y:0},[S,k,w,A]=Cs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*a[d]===-1){b=s.x??S,g=s.y??k;const I=[{x:b,y:c.y},{x:b,y:u.y}],V=[{x:c.x,y:g},{x:u.x,y:g}];r[d]===m?p=d==="x"?I:V:p=d==="x"?V:I}else{const I=[{x:c.x,y:u.y}],V=[{x:u.x,y:c.y}];if(d==="x"?p=r.x===m?V:I:p=r.y===m?I:V,t===o){const P=Math.abs(e[d]-n[d]);if(P<=i){const h=Math.min(i-1,i-P);r[d]===m?y[d]=(c[d]>e[d]?-1:1)*h:x[d]=(u[d]>n[d]?-1:1)*h}}if(t!==o){const P=d==="x"?"y":"x",h=r[d]===a[P],C=c[P]>u[P],v=c[P]<u[P];(r[d]===1&&(!h&&C||h&&v)||r[d]!==1&&(!h&&v||h&&C))&&(p=d==="x"?I:V)}const T={x:c.x+y.x,y:c.y+y.y},z={x:u.x+x.x,y:u.y+x.y},H=Math.max(Math.abs(T.x-p[0].x),Math.abs(z.x-p[0].x)),F=Math.max(Math.abs(T.y-p[0].y),Math.abs(z.y-p[0].y));H>=F?(b=(T.x+z.x)/2,g=p[0].y):(b=p[0].x,g=(T.y+z.y)/2)}return[[e,{x:c.x+y.x,y:c.y+y.y},...p,{x:u.x+x.x,y:u.y+x.y},n],b,g,w,A]}function Jl(e,t,n,o){const s=Math.min(Co(e,t)/2,Co(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${r+s*c}Q ${i},${r} ${i+s*a},${r}`}function kn({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top,borderRadius:r=5,centerX:a,centerY:c,offset:u=20}){const[l,d,m,p,b]=Kl({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:a,y:c},offset:u});return[l.reduce((y,x,S)=>{let k="";return S>0&&S<l.length-1?k=Jl(l[S-1],x,l[S+1],r):k=`${S===0?"M":"L"}${x.x} ${x.y}`,y+=k,y},""),d,m,p,b]}const Jt=N.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:d=Y.Bottom,targetPosition:m=Y.Top,markerEnd:p,markerStart:b,pathOptions:g,interactionWidth:y})=>{const[x,S,k]=kn({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:m,borderRadius:g?.borderRadius,offset:g?.offset});return _.createElement(Mt,{path:x,labelX:S,labelY:k,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:p,markerStart:b,interactionWidth:y})});Jt.displayName="SmoothStepEdge";const Bn=N.memo(e=>_.createElement(Jt,{...e,pathOptions:N.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Bn.displayName="StepEdge";function Ql({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,a]=Cs({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,a]}const Yn=N.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:m,interactionWidth:p})=>{const[b,g,y]=Ql({sourceX:e,sourceY:t,targetX:n,targetY:o});return _.createElement(Mt,{path:b,labelX:g,labelY:y,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:m,interactionWidth:p})});Yn.displayName="StraightEdge";function zt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ko({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case Y.Left:return[t-zt(t-o,i),n];case Y.Right:return[t+zt(o-t,i),n];case Y.Top:return[t,n-zt(n-s,i)];case Y.Bottom:return[t,n+zt(s-n,i)]}}function As({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:i=Y.Top,curvature:r=.25}){const[a,c]=ko({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,l]=ko({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,m,p,b]=ks({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${o},${s}`,d,m,p,b]}const Zt=N.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=Y.Bottom,targetPosition:i=Y.Top,label:r,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:m,markerEnd:p,markerStart:b,pathOptions:g,interactionWidth:y})=>{const[x,S,k]=As({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:g?.curvature});return _.createElement(Mt,{path:x,labelX:S,labelY:k,label:r,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:m,markerEnd:p,markerStart:b,interactionWidth:y})});Zt.displayName="BezierEdge";const Xn=N.createContext(null),eu=Xn.Provider;Xn.Consumer;const tu=()=>N.useContext(Xn),nu=e=>"id"in e&&"source"in e&&"target"in e,ou=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Mn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,su=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ru=(e,t)=>{if(!e.source||!e.target)return t;let n;return nu(e)?n={...e}:n={...e,id:ou(e)},su(n,t)?t:t.concat(n)},An=({x:e,y:t},[n,o,s],i,[r,a])=>{const c={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(c.x/r),y:a*Math.round(c.y/a)}:c},js=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Ye=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Qt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Ye(s,t).positionAbsolute;return Ns(o,Et({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Es(n)},Ts=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,a=[0,0])=>{const c={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(l=>{const{width:d,height:m,selectable:p=!0,hidden:b=!1}=l;if(r&&!p||b)return!1;const{positionAbsolute:g}=Ye(l,a),y={x:g.x,y:g.y,width:d||0,height:m||0},x=_n(c,y),S=typeof d>"u"||typeof m>"u"||d===null||m===null,k=i&&x>0,w=(d||0)*(m||0);(S||k||x>=w||l.dragging)&&u.push(l)}),u},$s=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},zs=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(r,a),u=ct(c,o,s),l=e.x+e.width/2,d=e.y+e.height/2,m=t/2-l*u,p=n/2-d*u;return{x:m,y:p,zoom:u}},Le=(e,t=0)=>e.transition().duration(t);function Mo(e,t,n,o){return(t[n]||[]).reduce((s,i)=>(`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),s),[])}function iu(e,t,n,o,s,i){const{x:r,y:a}=Ie(e),u=t.elementsFromPoint(r,a).find(b=>b.classList.contains("react-flow__handle"));if(u){const b=u.getAttribute("data-nodeid");if(b){const g=Zn(void 0,u),y=u.getAttribute("data-handleid"),x=i({nodeId:b,id:y,type:g});if(x){const S=s.find(k=>k.nodeId===b&&k.type===g&&k.id===y);return{handle:{id:y,type:g,nodeId:b,x:S?.x||n.x,y:S?.y||n.y},validHandleResult:x}}}}let l=[],d=1/0;if(s.forEach(b=>{const g=Math.sqrt((b.x-n.x)**2+(b.y-n.y)**2);if(g<=o){const y=i(b);g<=d&&(g<d?l=[{handle:b,validHandleResult:y}]:g===d&&l.push({handle:b,validHandleResult:y}),d=g)}}),!l.length)return{handle:null,validHandleResult:Is()};if(l.length===1)return l[0];const m=l.some(({validHandleResult:b})=>b.isValid),p=l.some(({handle:b})=>b.type==="target");return l.find(({handle:b,validHandleResult:g})=>p?b.type==="target":m?g.isValid:!0)||l[0]}const au={source:null,target:null,sourceHandle:null,targetHandle:null},Is=()=>({handleDomNode:null,isValid:!1,connection:au,endHandle:null});function Ds(e,t,n,o,s,i,r){const a=s==="target",c=r.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...Is(),handleDomNode:c};if(c){const l=Zn(void 0,c),d=c.getAttribute("data-nodeid"),m=c.getAttribute("data-handleid"),p=c.classList.contains("connectable"),b=c.classList.contains("connectableend"),g={source:a?d:n,sourceHandle:a?m:o,target:a?n:d,targetHandle:a?o:m};u.connection=g,p&&b&&(t===Ze.Strict?a&&l==="source"||!a&&l==="target":d!==n||m!==o)&&(u.endHandle={nodeId:d,handleId:m,type:l},u.isValid=i(g))}return u}function cu({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[te]){const{handleBounds:r}=i[te];let a=[],c=[];r&&(a=Mo(i,r,"source",`${t}-${n}-${o}`),c=Mo(i,r,"target",`${t}-${n}-${o}`)),s.push(...a,...c)}return s},[])}function Zn(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function dn(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function lu(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Rs({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=vs(e.target),{connectionMode:d,domNode:m,autoPanOnConnect:p,connectionRadius:b,onConnectStart:g,panBy:y,getNodes:x,cancelConnection:S}=i();let k=0,w;const{x:A,y:M}=Ie(e),I=l?.elementFromPoint(A,M),V=Zn(c,I),T=m?.getBoundingClientRect();if(!T||!V)return;let z,H=Ie(e,T),F=!1,P=null,h=!1,C=null;const v=cu({nodes:x(),nodeId:n,handleId:t,handleType:V}),j=()=>{if(!p)return;const[$,D]=bs(H,T);y({x:$,y:D}),k=requestAnimationFrame(j)};r({connectionPosition:H,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:V,connectionStartHandle:{nodeId:n,handleId:t,type:V},connectionEndHandle:null}),g?.(e,{nodeId:n,handleId:t,handleType:V});function R($){const{transform:D}=i();H=Ie($,T);const{handle:O,validHandleResult:B}=iu($,l,An(H,D,!1,[1,1]),b,v,L=>Ds(L,d,n,t,s?"target":"source",a,l));if(w=O,F||(j(),F=!0),C=B.handleDomNode,P=B.connection,h=B.isValid,r({connectionPosition:w&&h?js({x:w.x,y:w.y},D):H,connectionStatus:lu(!!w,h),connectionEndHandle:B.endHandle}),!w&&!h&&!C)return dn(z);P.source!==P.target&&C&&(dn(z),z=C,C.classList.add("connecting","react-flow__handle-connecting"),C.classList.toggle("valid",h),C.classList.toggle("react-flow__handle-valid",h))}function E($){(w||C)&&P&&h&&o?.(P),i().onConnectEnd?.($),c&&u?.($),dn(z),S(),cancelAnimationFrame(k),F=!1,h=!1,P=null,C=null,l.removeEventListener("mousemove",R),l.removeEventListener("mouseup",E),l.removeEventListener("touchmove",R),l.removeEventListener("touchend",E)}l.addEventListener("mousemove",R),l.addEventListener("mouseup",E),l.addEventListener("touchmove",R),l.addEventListener("touchend",E)}const Ao=()=>!0,uu=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),du=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||i?.nodeId===e&&i?.handleId===t&&i?.type===n,clickConnecting:r?.nodeId===e&&r?.handleId===t&&r?.type===n}},Ps=N.forwardRef(({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:d,...m},p)=>{const b=r||null,g=e==="target",y=se(),x=tu(),{connectOnClick:S,noPanClassName:k}=ee(uu,re),{connecting:w,clickConnecting:A}=ee(du(x,b,e),re);x||y.getState().onError?.("010",Ae.error010());const M=T=>{const{defaultEdgeOptions:z,onConnect:H,hasDefaultEdges:F}=y.getState(),P={...z,...T};if(F){const{edges:h,setEdges:C}=y.getState();C(ru(P,h))}H?.(P),a?.(P)},I=T=>{if(!x)return;const z=_s(T);s&&(z&&T.button===0||!z)&&Rs({event:T,handleId:b,nodeId:x,onConnect:M,isTarget:g,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||Ao}),z?l?.(T):d?.(T)},V=T=>{const{onClickConnectStart:z,onClickConnectEnd:H,connectionClickStartHandle:F,connectionMode:P,isValidConnection:h}=y.getState();if(!x||!F&&!s)return;if(!F){z?.(T,{nodeId:x,handleId:b,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:b}});return}const C=vs(T.target),v=n||h||Ao,{connection:j,isValid:R}=Ds({nodeId:x,id:b,type:e},P,F.nodeId,F.handleId||null,F.type,v,C);R&&M(j),H?.(T),y.setState({connectionClickStartHandle:null})};return _.createElement("div",{"data-handleid":b,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${b}-${e}`,className:ae(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",k,u,{source:!g,target:g,connectable:o,connectablestart:s,connectableend:i,connecting:A,connectionindicator:o&&(s&&!w||i&&w)}]),onMouseDown:I,onTouchStart:I,onClick:S?V:void 0,ref:p,...m},c)});Ps.displayName="Handle";var ze=N.memo(Ps);const Hs=({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom})=>_.createElement(_.Fragment,null,_.createElement(ze,{type:"target",position:n,isConnectable:t}),e?.label,_.createElement(ze,{type:"source",position:o,isConnectable:t}));Hs.displayName="DefaultNode";var jn=N.memo(Hs);const Vs=({data:e,isConnectable:t,sourcePosition:n=Y.Bottom})=>_.createElement(_.Fragment,null,e?.label,_.createElement(ze,{type:"source",position:n,isConnectable:t}));Vs.displayName="InputNode";var Os=N.memo(Vs);const Fs=({data:e,isConnectable:t,targetPosition:n=Y.Top})=>_.createElement(_.Fragment,null,_.createElement(ze,{type:"target",position:n,isConnectable:t}),e?.label);Fs.displayName="OutputNode";var Ls=N.memo(Fs);const Un=()=>null;Un.displayName="GroupNode";const fu=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),It=e=>e.id;function hu(e,t){return re(e.selectedNodes.map(It),t.selectedNodes.map(It))&&re(e.selectedEdges.map(It),t.selectedEdges.map(It))}const Bs=N.memo(({onSelectionChange:e})=>{const t=se(),{selectedNodes:n,selectedEdges:o}=ee(fu,hu);return N.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});Bs.displayName="SelectionListener";const mu=e=>!!e.onSelectionChange;function pu({onSelectionChange:e}){const t=ee(mu);return e||t?_.createElement(Bs,{onSelectionChange:e}):null}const gu=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Qe(e,t){N.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function W(e,t,n){N.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const xu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:d,edgesFocusable:m,edgesUpdatable:p,elevateNodesOnSelect:b,minZoom:g,maxZoom:y,nodeExtent:x,onNodesChange:S,onEdgesChange:k,elementsSelectable:w,connectionMode:A,snapGrid:M,snapToGrid:I,translateExtent:V,connectOnClick:T,defaultEdgeOptions:z,fitView:H,fitViewOptions:F,onNodesDelete:P,onEdgesDelete:h,onNodeDrag:C,onNodeDragStart:v,onNodeDragStop:j,onSelectionDrag:R,onSelectionDragStart:E,onSelectionDragStop:$,noPanClassName:D,nodeOrigin:O,rfId:B,autoPanOnConnect:L,autoPanOnNodeDrag:Z,onError:U,connectionRadius:G,isValidConnection:J,nodeDragThreshold:K})=>{const{setNodes:q,setEdges:ie,setDefaultNodesAndEdges:oe,setMinZoom:ue,setMaxZoom:ce,setTranslateExtent:ne,setNodeExtent:fe,reset:Q}=ee(gu,re),X=se();return N.useEffect(()=>{const de=o?.map(Ne=>({...Ne,...z}));return oe(n,de),()=>{Q()}},[]),W("defaultEdgeOptions",z,X.setState),W("connectionMode",A,X.setState),W("onConnect",s,X.setState),W("onConnectStart",i,X.setState),W("onConnectEnd",r,X.setState),W("onClickConnectStart",a,X.setState),W("onClickConnectEnd",c,X.setState),W("nodesDraggable",u,X.setState),W("nodesConnectable",l,X.setState),W("nodesFocusable",d,X.setState),W("edgesFocusable",m,X.setState),W("edgesUpdatable",p,X.setState),W("elementsSelectable",w,X.setState),W("elevateNodesOnSelect",b,X.setState),W("snapToGrid",I,X.setState),W("snapGrid",M,X.setState),W("onNodesChange",S,X.setState),W("onEdgesChange",k,X.setState),W("connectOnClick",T,X.setState),W("fitViewOnInit",H,X.setState),W("fitViewOnInitOptions",F,X.setState),W("onNodesDelete",P,X.setState),W("onEdgesDelete",h,X.setState),W("onNodeDrag",C,X.setState),W("onNodeDragStart",v,X.setState),W("onNodeDragStop",j,X.setState),W("onSelectionDrag",R,X.setState),W("onSelectionDragStart",E,X.setState),W("onSelectionDragStop",$,X.setState),W("noPanClassName",D,X.setState),W("nodeOrigin",O,X.setState),W("rfId",B,X.setState),W("autoPanOnConnect",L,X.setState),W("autoPanOnNodeDrag",Z,X.setState),W("onError",U,X.setState),W("connectionRadius",G,X.setState),W("isValidConnection",J,X.setState),W("nodeDragThreshold",K,X.setState),Qe(e,q),Qe(t,ie),Qe(g,ue),Qe(y,ce),Qe(V,ne),Qe(x,fe),null},jo={display:"none"},yu={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ys="react-flow__node-desc",Xs="react-flow__edge-desc",wu="react-flow__aria-live",bu=e=>e.ariaLiveMessage;function vu({rfId:e}){const t=ee(bu);return _.createElement("div",{id:`${wu}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:yu},t)}function Nu({rfId:e,disableKeyboardA11y:t}){return _.createElement(_.Fragment,null,_.createElement("div",{id:`${Ys}-${e}`,style:jo},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),_.createElement("div",{id:`${Xs}-${e}`,style:jo},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&_.createElement(vu,{rfId:e}))}var Ct=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=N.useState(!1),s=N.useRef(!1),i=N.useRef(new Set([])),[r,a]=N.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),l=u.reduce((d,m)=>d.concat(...m),[]);return[u,l]}return[[],[]]},[e]);return N.useEffect(()=>{const c=typeof document<"u"?document:null,u=t?.target||c;if(e!==null){const l=p=>{if(s.current=p.ctrlKey||p.metaKey||p.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Cn(p))return!1;const g=$o(p.code,a);i.current.add(p[g]),To(r,i.current,!1)&&(p.preventDefault(),o(!0))},d=p=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Cn(p))return!1;const g=$o(p.code,a);To(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(p[g]),p.key==="Meta"&&i.current.clear(),s.current=!1},m=()=>{i.current.clear(),o(!1)};return u?.addEventListener("keydown",l),u?.addEventListener("keyup",d),window.addEventListener("blur",m),()=>{u?.removeEventListener("keydown",l),u?.removeEventListener("keyup",d),window.removeEventListener("blur",m)}}},[e,o]),n};function To(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function $o(e,t){return t.includes(e)?"code":"key"}function Zs(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),r=Ye(i,o);return Zs(i,t,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(i[te]?.z??0)>(n.z??0)?i[te]?.z??0:n.z??0},o)}function Us(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:i,y:r,z:a}=Zs(o,e,{...o.position,z:o[te]?.z??0},t);o.positionAbsolute={x:i,y:r},o[te].z=a,n?.[o.id]&&(o[te].isParent=!0)}})}function fn(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(a=>{const c=(pe(a.zIndex)?a.zIndex:0)+(a.selected?r:0),u=t.get(a.id),l={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(i[d]=!0);const m=u?.type&&u?.type!==a.type;Object.defineProperty(l,te,{enumerable:!1,value:{handleBounds:m?void 0:u?.[te]?.handleBounds,z:c}}),s.set(a.id,l)}),Us(s,n,i),s}function Ws(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:d}=e(),m=t.initial&&!u&&l;if(a&&c&&(m||!t.initial)){const b=n().filter(y=>{const x=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return t.nodes?.length?x&&t.nodes.some(S=>S.id===y.id):x}),g=b.every(y=>y.width&&y.height);if(b.length>0&&g){const y=Qt(b,d),{x,y:S,zoom:k}=zs(y,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),w=ke.translate(x,S).scale(k);return typeof t.duration=="number"&&t.duration>0?a.transform(Le(c,t.duration),w):a.transform(c,w),!0}}return!1}function Eu(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[te]:o[te],selected:n.selected})}),new Map(t)}function Su(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function Dt({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e?.length&&(c&&o({nodeInternals:Eu(e,s)}),r?.(e)),t?.length&&(u&&o({edges:Su(t,i)}),a?.(t))}const et=()=>{},_u={zoomIn:et,zoomOut:et,zoomTo:et,getZoom:()=>1,setViewport:et,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:et,fitBounds:et,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Cu=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),ku=()=>{const e=se(),{d3Zoom:t,d3Selection:n}=ee(Cu,re);return N.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(Le(n,s?.duration),1.2),zoomOut:s=>t.scaleBy(Le(n,s?.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(Le(n,i?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,a,c]=e.getState().transform,u=ke.translate(s.x??r,s.y??a).scale(s.zoom??c);t.transform(Le(n,i?.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Ws(e.getState,s),setCenter:(s,i,r)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof r?.zoom<"u"?r.zoom:u,d=a/2-s*l,m=c/2-i*l,p=ke.translate(d,m).scale(l);t.transform(Le(n,r?.duration),p)},fitBounds:(s,i)=>{const{width:r,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:d,zoom:m}=zs(s,r,a,c,u,i?.padding??.1),p=ke.translate(l,d).scale(m);t.transform(Le(n,i?.duration),p)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),An(s,i,r,a)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:a,domNode:c}=e.getState();if(!c)return s;const{x:u,y:l}=c.getBoundingClientRect(),d={x:s.x-u,y:s.y-l};return An(d,i,r,a)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:a,y:c}=r.getBoundingClientRect(),u=js(s,i);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:_u,[t,n])};function Wn(){const e=ku(),t=se(),n=N.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),o=N.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=N.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(y=>({...y}))},[]),i=N.useCallback(g=>{const{edges:y=[]}=t.getState();return y.find(x=>x.id===g)},[]),r=N.useCallback(g=>{const{getNodes:y,setNodes:x,hasDefaultNodes:S,onNodesChange:k}=t.getState(),w=y(),A=typeof g=="function"?g(w):g;if(S)x(A);else if(k){const M=A.length===0?w.map(I=>({type:"remove",id:I.id})):A.map(I=>({item:I,type:"reset"}));k(M)}},[]),a=N.useCallback(g=>{const{edges:y=[],setEdges:x,hasDefaultEdges:S,onEdgesChange:k}=t.getState(),w=typeof g=="function"?g(y):g;if(S)x(w);else if(k){const A=w.length===0?y.map(M=>({type:"remove",id:M.id})):w.map(M=>({item:M,type:"reset"}));k(A)}},[]),c=N.useCallback(g=>{const y=Array.isArray(g)?g:[g],{getNodes:x,setNodes:S,hasDefaultNodes:k,onNodesChange:w}=t.getState();if(k){const M=[...x(),...y];S(M)}else if(w){const A=y.map(M=>({item:M,type:"add"}));w(A)}},[]),u=N.useCallback(g=>{const y=Array.isArray(g)?g:[g],{edges:x=[],setEdges:S,hasDefaultEdges:k,onEdgesChange:w}=t.getState();if(k)S([...x,...y]);else if(w){const A=y.map(M=>({item:M,type:"add"}));w(A)}},[]),l=N.useCallback(()=>{const{getNodes:g,edges:y=[],transform:x}=t.getState(),[S,k,w]=x;return{nodes:g().map(A=>({...A})),edges:y.map(A=>({...A})),viewport:{x:S,y:k,zoom:w}}},[]),d=N.useCallback(({nodes:g,edges:y})=>{const{nodeInternals:x,getNodes:S,edges:k,hasDefaultNodes:w,hasDefaultEdges:A,onNodesDelete:M,onEdgesDelete:I,onNodesChange:V,onEdgesChange:T}=t.getState(),z=(g||[]).map(C=>C.id),H=(y||[]).map(C=>C.id),F=S().reduce((C,v)=>{const j=v.parentNode||v.parentId,R=!z.includes(v.id)&&j&&C.find($=>$.id===j);return(typeof v.deletable=="boolean"?v.deletable:!0)&&(z.includes(v.id)||R)&&C.push(v),C},[]),P=k.filter(C=>typeof C.deletable=="boolean"?C.deletable:!0),h=P.filter(C=>H.includes(C.id));if(F||h){const C=$s(F,P),v=[...h,...C],j=v.reduce((R,E)=>(R.includes(E.id)||R.push(E.id),R),[]);if((A||w)&&(A&&t.setState({edges:k.filter(R=>!j.includes(R.id))}),w&&(F.forEach(R=>{x.delete(R.id)}),t.setState({nodeInternals:new Map(x)}))),j.length>0&&(I?.(v),T&&T(j.map(R=>({id:R,type:"remove"})))),F.length>0&&(M?.(F),V)){const R=F.map(E=>({id:E.id,type:"remove"}));V(R)}}},[]),m=N.useCallback(g=>{const y=Ul(g),x=y?null:t.getState().nodeInternals.get(g.id);return!y&&!x?[null,null,y]:[y?g:Eo(x),x,y]},[]),p=N.useCallback((g,y=!0,x)=>{const[S,k,w]=m(g);return S?(x||t.getState().getNodes()).filter(A=>{if(!w&&(A.id===k.id||!A.positionAbsolute))return!1;const M=Eo(A),I=_n(M,S);return y&&I>0||I>=S.width*S.height}):[]},[]),b=N.useCallback((g,y,x=!0)=>{const[S]=m(g);if(!S)return!1;const k=_n(S,y);return x&&k>0||k>=S.width*S.height},[]);return N.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:d,getIntersectingNodes:p,isNodeIntersecting:b}),[e,n,o,s,i,r,a,c,u,l,d,p,b])}const Mu={actInsideInputWithModifier:!1};var Au=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=se(),{deleteElements:o}=Wn(),s=Ct(e,Mu),i=Ct(t);N.useEffect(()=>{if(s){const{edges:r,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=r.filter(l=>l.selected);o({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),N.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function ju(e){const t=se();N.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=On(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",Ae.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Gn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Tu=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Rt=e=>({x:e.x,y:e.y,zoom:e.k}),tt=(e,t)=>e.target.closest(`.${t}`),zo=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Io=e=>{const t=e.ctrlKey&&Xt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},$u=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),zu=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Be.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:d=!0,defaultViewport:m,translateExtent:p,minZoom:b,maxZoom:g,zoomActivationKeyCode:y,preventScrolling:x=!0,children:S,noWheelClassName:k,noPanClassName:w})=>{const A=N.useRef(),M=se(),I=N.useRef(!1),V=N.useRef(!1),T=N.useRef(null),z=N.useRef({x:0,y:0,zoom:0}),{d3Zoom:H,d3Selection:F,d3ZoomHandler:P,userSelectionActive:h}=ee($u,re),C=Ct(y),v=N.useRef(0),j=N.useRef(!1),R=N.useRef();return ju(T),N.useEffect(()=>{if(T.current){const E=T.current.getBoundingClientRect(),$=ys().scaleExtent([b,g]).translateExtent(p),D=me(T.current).call($),O=ke.translate(m.x,m.y).scale(ct(m.zoom,b,g)),B=[[0,0],[E.width,E.height]],L=$.constrain()(O,B,p);$.transform(D,L),$.wheelDelta(Io),M.setState({d3Zoom:$,d3Selection:D,d3ZoomHandler:D.on("wheel.zoom"),transform:[L.x,L.y,L.k],domNode:T.current.closest(".react-flow")})}},[]),N.useEffect(()=>{F&&H&&(r&&!C&&!h?F.on("wheel.zoom",E=>{if(tt(E,k))return!1;E.preventDefault(),E.stopImmediatePropagation();const $=F.property("__zoom").k||1;if(E.ctrlKey&&i){const J=xe(E),K=Io(E),q=$*Math.pow(2,K);H.scaleTo(F,q,J,E);return}const D=E.deltaMode===1?20:1;let O=c===Be.Vertical?0:E.deltaX*D,B=c===Be.Horizontal?0:E.deltaY*D;!Xt()&&E.shiftKey&&c!==Be.Vertical&&(O=E.deltaY*D,B=0),H.translateBy(F,-(O/$)*a,-(B/$)*a,{internal:!0});const L=Rt(F.property("__zoom")),{onViewportChangeStart:Z,onViewportChange:U,onViewportChangeEnd:G}=M.getState();clearTimeout(R.current),j.current||(j.current=!0,t?.(E,L),Z?.(L)),j.current&&(e?.(E,L),U?.(L),R.current=setTimeout(()=>{n?.(E,L),G?.(L),j.current=!1},150))},{passive:!1}):typeof P<"u"&&F.on("wheel.zoom",function(E,$){if(!x&&E.type==="wheel"&&!E.ctrlKey||tt(E,k))return null;E.preventDefault(),P.call(this,E,$)},{passive:!1}))},[h,r,c,F,H,P,C,i,x,k,t,e,n]),N.useEffect(()=>{H&&H.on("start",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;v.current=E.sourceEvent?.button;const{onViewportChangeStart:$}=M.getState(),D=Rt(E.transform);I.current=!0,z.current=D,E.sourceEvent?.type==="mousedown"&&M.setState({paneDragging:!0}),$?.(D),t?.(E.sourceEvent,D)})},[H,t]),N.useEffect(()=>{H&&(h&&!I.current?H.on("zoom",null):h||H.on("zoom",E=>{const{onViewportChange:$}=M.getState();if(M.setState({transform:[E.transform.x,E.transform.y,E.transform.k]}),V.current=!!(o&&zo(d,v.current??0)),(e||$)&&!E.sourceEvent?.internal){const D=Rt(E.transform);$?.(D),e?.(E.sourceEvent,D)}}))},[h,H,e,d,o]),N.useEffect(()=>{H&&H.on("end",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;const{onViewportChangeEnd:$}=M.getState();if(I.current=!1,M.setState({paneDragging:!1}),o&&zo(d,v.current??0)&&!V.current&&o(E.sourceEvent),V.current=!1,(n||$)&&Tu(z.current,E.transform)){const D=Rt(E.transform);z.current=D,clearTimeout(A.current),A.current=setTimeout(()=>{$?.(D),n?.(E.sourceEvent,D)},r?150:0)}})},[H,r,d,n,o]),N.useEffect(()=>{H&&H.filter(E=>{const $=C||s,D=i&&E.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&E.button===1&&E.type==="mousedown"&&(tt(E,"react-flow__node")||tt(E,"react-flow__edge")))return!0;if(!d&&!$&&!r&&!u&&!i||h||!u&&E.type==="dblclick"||tt(E,k)&&E.type==="wheel"||tt(E,w)&&(E.type!=="wheel"||r&&E.type==="wheel"&&!C)||!i&&E.ctrlKey&&E.type==="wheel"||!$&&!r&&!D&&E.type==="wheel"||!d&&(E.type==="mousedown"||E.type==="touchstart")||Array.isArray(d)&&!d.includes(E.button)&&E.type==="mousedown")return!1;const O=Array.isArray(d)&&d.includes(E.button)||!E.button||E.button<=1;return(!E.ctrlKey||E.type==="wheel")&&O})},[h,H,s,i,r,u,d,l,C]),_.createElement("div",{className:"react-flow__renderer",ref:T,style:Gn},S)},Iu=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Du(){const{userSelectionActive:e,userSelectionRect:t}=ee(Iu,re);return e&&t?_.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Do(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),i>0&&(o.style.height+=i),t.position.x<0){const r=Math.abs(t.position.x);o.position.x=o.position.x-r,o.style.width+=r,t.position.x=0}if(t.position.y<0){const r=Math.abs(t.position.y);o.position.y=o.position.y-r,o.style.height+=r,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Gs(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(a=>a.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const a of i)if(a)switch(a.type){case"select":{r.selected=a.selected;break}case"position":{typeof a.position<"u"&&(r.position=a.position),typeof a.positionAbsolute<"u"&&(r.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(r.dragging=a.dragging),r.expandParent&&Do(o,r);break}case"dimensions":{typeof a.dimensions<"u"&&(r.width=a.dimensions.width,r.height=a.dimensions.height),typeof a.updateStyle<"u"&&(r.style={...r.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(r.resizing=a.resizing),r.expandParent&&Do(o,r);break}case"remove":return o}return o.push(r),o},n)}function qs(e,t){return Gs(e,t)}function Ru(e,t){return Gs(e,t)}const Te=(e,t)=>({id:e,type:"select",selected:t});function ot(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(Te(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(Te(o.id,!1))),n},[])}const hn=(e,t)=>n=>{n.target===t.current&&e?.(n)},Pu=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Ks=N.memo(({isSelecting:e,selectionMode:t=St.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:d})=>{const m=N.useRef(null),p=se(),b=N.useRef(0),g=N.useRef(0),y=N.useRef(),{userSelectionActive:x,elementsSelectable:S,dragging:k}=ee(Pu,re),w=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),b.current=0,g.current=0},A=P=>{i?.(P),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},M=P=>{if(Array.isArray(n)&&n?.includes(2)){P.preventDefault();return}r?.(P)},I=a?P=>a(P):void 0,V=P=>{const{resetSelectedElements:h,domNode:C}=p.getState();if(y.current=C?.getBoundingClientRect(),!S||!e||P.button!==0||P.target!==m.current||!y.current)return;const{x:v,y:j}=Ie(P,y.current);h(),p.setState({userSelectionRect:{width:0,height:0,startX:v,startY:j,x:v,y:j}}),o?.(P)},T=P=>{const{userSelectionRect:h,nodeInternals:C,edges:v,transform:j,onNodesChange:R,onEdgesChange:E,nodeOrigin:$,getNodes:D}=p.getState();if(!e||!y.current||!h)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const O=Ie(P,y.current),B=h.startX??0,L=h.startY??0,Z={...h,x:O.x<B?O.x:B,y:O.y<L?O.y:L,width:Math.abs(O.x-B),height:Math.abs(O.y-L)},U=D(),G=Ts(C,Z,j,t===St.Partial,!0,$),J=$s(G,v).map(q=>q.id),K=G.map(q=>q.id);if(b.current!==K.length){b.current=K.length;const q=ot(U,K);q.length&&R?.(q)}if(g.current!==J.length){g.current=J.length;const q=ot(v,J);q.length&&E?.(q)}p.setState({userSelectionRect:Z})},z=P=>{if(P.button!==0)return;const{userSelectionRect:h}=p.getState();!x&&h&&P.target===m.current&&A?.(P),p.setState({nodesSelectionActive:b.current>0}),w(),s?.(P)},H=P=>{x&&(p.setState({nodesSelectionActive:b.current>0}),s?.(P)),w()},F=S&&(e||x);return _.createElement("div",{className:ae(["react-flow__pane",{dragging:k,selection:e}]),onClick:F?void 0:hn(A,m),onContextMenu:hn(M,m),onWheel:hn(I,m),onMouseEnter:F?void 0:c,onMouseDown:F?V:void 0,onMouseMove:F?T:u,onMouseUp:F?z:void 0,onMouseLeave:F?H:l,ref:m,style:Gn},d,_.createElement(Du,null))});Ks.displayName="Pane";function Js(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:Js(o,t):!1}function Ro(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Hu(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Js(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function Vu(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Qs(e,t,n,o,s=[0,0],i){const r=Vu(e,e.extent||o);let a=r;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const d=n.get(c),{x:m,y:p}=Ye(d,s).positionAbsolute;a=d&&pe(m)&&pe(p)&&pe(d.width)&&pe(d.height)?[[m+e.width*s[0],p+e.height*s[1]],[m+d.width-e.width+e.width*s[0],p+d.height-e.height+e.height*s[1]]]:a}else i?.("005",Ae.error005()),a=r;else if(e.extent&&c&&e.extent!=="parent"){const d=n.get(c),{x:m,y:p}=Ye(d,s).positionAbsolute;a=[[e.extent[0][0]+m,e.extent[0][1]+p],[e.extent[1][0]+m,e.extent[1][1]+p]]}let u={x:0,y:0};if(c){const d=n.get(c);u=Ye(d,s).positionAbsolute}const l=a&&a!=="parent"?Fn(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function mn({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const Po=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),a={x:r.width*o[0],y:r.height*o[1]};return i.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-r.left-a.x)/n,y:(u.top-r.top-a.y)/n,...On(c)}})};function gt(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function Tn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c?.("012",Ae.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function Ou(){const e=se();return N.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(r-o[0])/o[2],y:(a-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function pn(e){return(t,n,o)=>e?.(t,o)}function er({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const a=se(),[c,u]=N.useState(!1),l=N.useRef([]),d=N.useRef({x:null,y:null}),m=N.useRef(0),p=N.useRef(null),b=N.useRef({x:0,y:0}),g=N.useRef(null),y=N.useRef(!1),x=N.useRef(!1),S=N.useRef(!1),k=Ou();return N.useEffect(()=>{if(e?.current){const w=me(e.current),A=({x:V,y:T})=>{const{nodeInternals:z,onNodeDrag:H,onSelectionDrag:F,updateNodePositions:P,nodeExtent:h,snapGrid:C,snapToGrid:v,nodeOrigin:j,onError:R}=a.getState();d.current={x:V,y:T};let E=!1,$={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&h){const O=Qt(l.current,j);$=Et(O)}if(l.current=l.current.map(O=>{const B={x:V-O.distance.x,y:T-O.distance.y};v&&(B.x=C[0]*Math.round(B.x/C[0]),B.y=C[1]*Math.round(B.y/C[1]));const L=[[h[0][0],h[0][1]],[h[1][0],h[1][1]]];l.current.length>1&&h&&!O.extent&&(L[0][0]=O.positionAbsolute.x-$.x+h[0][0],L[1][0]=O.positionAbsolute.x+(O.width??0)-$.x2+h[1][0],L[0][1]=O.positionAbsolute.y-$.y+h[0][1],L[1][1]=O.positionAbsolute.y+(O.height??0)-$.y2+h[1][1]);const Z=Qs(O,B,z,L,j,R);return E=E||O.position.x!==Z.position.x||O.position.y!==Z.position.y,O.position=Z.position,O.positionAbsolute=Z.positionAbsolute,O}),!E)return;P(l.current,!0,!0),u(!0);const D=s?H:pn(F);if(D&&g.current){const[O,B]=mn({nodeId:s,dragItems:l.current,nodeInternals:z});D(g.current,O,B)}},M=()=>{if(!p.current)return;const[V,T]=bs(b.current,p.current);if(V!==0||T!==0){const{transform:z,panBy:H}=a.getState();d.current.x=(d.current.x??0)-V/z[2],d.current.y=(d.current.y??0)-T/z[2],H({x:V,y:T})&&A(d.current)}m.current=requestAnimationFrame(M)},I=V=>{const{nodeInternals:T,multiSelectionActive:z,nodesDraggable:H,unselectNodesAndEdges:F,onNodeDragStart:P,onSelectionDragStart:h}=a.getState();x.current=!0;const C=s?P:pn(h);(!r||!i)&&!z&&s&&(T.get(s)?.selected||F()),s&&i&&r&&Tn({id:s,store:a,nodeRef:e});const v=k(V);if(d.current=v,l.current=Hu(T,H,v,s),C&&l.current){const[j,R]=mn({nodeId:s,dragItems:l.current,nodeInternals:T});C(V.sourceEvent,j,R)}};if(t)w.on(".drag",null);else{const V=Ec().on("start",T=>{const{domNode:z,nodeDragThreshold:H}=a.getState();H===0&&I(T),S.current=!1;const F=k(T);d.current=F,p.current=z?.getBoundingClientRect()||null,b.current=Ie(T.sourceEvent,p.current)}).on("drag",T=>{const z=k(T),{autoPanOnNodeDrag:H,nodeDragThreshold:F}=a.getState();if(T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1&&(S.current=!0),!S.current){if(!y.current&&x.current&&H&&(y.current=!0,M()),!x.current){const P=z.xSnapped-(d?.current?.x??0),h=z.ySnapped-(d?.current?.y??0);Math.sqrt(P*P+h*h)>F&&I(T)}(d.current.x!==z.xSnapped||d.current.y!==z.ySnapped)&&l.current&&x.current&&(g.current=T.sourceEvent,b.current=Ie(T.sourceEvent,p.current),A(z))}}).on("end",T=>{if(!(!x.current||S.current)&&(u(!1),y.current=!1,x.current=!1,cancelAnimationFrame(m.current),l.current)){const{updateNodePositions:z,nodeInternals:H,onNodeDragStop:F,onSelectionDragStop:P}=a.getState(),h=s?F:pn(P);if(z(l.current,!1,!1),h){const[C,v]=mn({nodeId:s,dragItems:l.current,nodeInternals:H});h(T.sourceEvent,C,v)}}}).filter(T=>{const z=T.target;return!T.button&&(!n||!Ro(z,`.${n}`,e))&&(!o||Ro(z,o,e))});return w.call(V),()=>{w.on(".drag",null)}}}},[e,t,n,o,i,a,s,r,k]),c}function tr(){const e=se();return N.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),d=r().filter(S=>S.selected&&(S.draggable||l&&typeof S.draggable>"u")),m=a?c[0]:5,p=a?c[1]:5,b=n.isShiftPressed?4:1,g=n.x*m*b,y=n.y*p*b,x=d.map(S=>{if(S.positionAbsolute){const k={x:S.positionAbsolute.x+g,y:S.positionAbsolute.y+y};a&&(k.x=c[0]*Math.round(k.x/c[0]),k.y=c[1]*Math.round(k.y/c[1]));const{positionAbsolute:w,position:A}=Qs(S,k,o,s,void 0,u);S.position=A,S.positionAbsolute=w}return S});i(x,!0,!1)},[])}const rt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var xt=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:d,onMouseMove:m,onMouseLeave:p,onContextMenu:b,onDoubleClick:g,style:y,className:x,isDraggable:S,isSelectable:k,isConnectable:w,isFocusable:A,selectNodesOnDrag:M,sourcePosition:I,targetPosition:V,hidden:T,resizeObserver:z,dragHandle:H,zIndex:F,isParent:P,noDragClassName:h,noPanClassName:C,initialized:v,disableKeyboardA11y:j,ariaLabel:R,rfId:E,hasHandleBounds:$})=>{const D=se(),O=N.useRef(null),B=N.useRef(null),L=N.useRef(I),Z=N.useRef(V),U=N.useRef(o),G=k||S||l||d||m||p,J=tr(),K=gt(n,D.getState,d),q=gt(n,D.getState,m),ie=gt(n,D.getState,p),oe=gt(n,D.getState,b),ue=gt(n,D.getState,g),ce=Q=>{const{nodeDragThreshold:X}=D.getState();if(k&&(!M||!S||X>0)&&Tn({id:n,store:D,nodeRef:O}),l){const de=D.getState().nodeInternals.get(n);de&&l(Q,{...de})}},ne=Q=>{if(!Cn(Q)&&!j)if(Ss.includes(Q.key)&&k){const X=Q.key==="Escape";Tn({id:n,store:D,unselect:X,nodeRef:O})}else S&&u&&Object.prototype.hasOwnProperty.call(rt,Q.key)&&(D.setState({ariaLiveMessage:`Moved selected node ${Q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),J({x:rt[Q.key].x,y:rt[Q.key].y,isShiftPressed:Q.shiftKey}))};N.useEffect(()=>()=>{B.current&&(z?.unobserve(B.current),B.current=null)},[]),N.useEffect(()=>{if(O.current&&!T){const Q=O.current;(!v||!$||B.current!==Q)&&(B.current&&z?.unobserve(B.current),z?.observe(Q),B.current=Q)}},[T,v,$]),N.useEffect(()=>{const Q=U.current!==o,X=L.current!==I,de=Z.current!==V;O.current&&(Q||X||de)&&(Q&&(U.current=o),X&&(L.current=I),de&&(Z.current=V),D.getState().updateNodeDimensions([{id:n,nodeElement:O.current,forceUpdate:!0}]))},[n,o,I,V]);const fe=er({nodeRef:O,disabled:T||!S,noDragClassName:h,handleSelector:H,nodeId:n,isSelectable:k,selectNodesOnDrag:M});return T?null:_.createElement("div",{className:ae(["react-flow__node",`react-flow__node-${o}`,{[C]:S},x,{selected:u,selectable:k,parent:P,dragging:fe}]),ref:O,style:{zIndex:F,transform:`translate(${a}px,${c}px)`,pointerEvents:G?"all":"none",visibility:v?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:K,onMouseMove:q,onMouseLeave:ie,onContextMenu:oe,onClick:ce,onDoubleClick:ue,onKeyDown:A?ne:void 0,tabIndex:A?0:void 0,role:A?"button":void 0,"aria-describedby":j?void 0:`${Ys}-${E}`,"aria-label":R},_.createElement(eu,{value:n},_.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:w,sourcePosition:I,targetPosition:V,dragging:fe,dragHandle:H,zIndex:F})))};return t.displayName="NodeWrapper",N.memo(t)};const Fu=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Qt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Lu({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=se(),{width:s,height:i,x:r,y:a,transformString:c,userSelectionActive:u}=ee(Fu,re),l=tr(),d=N.useRef(null);if(N.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),er({nodeRef:d}),u||!s||!i)return null;const m=e?b=>{const g=o.getState().getNodes().filter(y=>y.selected);e(b,g)}:void 0,p=b=>{Object.prototype.hasOwnProperty.call(rt,b.key)&&l({x:rt[b.key].x,y:rt[b.key].y,isShiftPressed:b.shiftKey})};return _.createElement("div",{className:ae(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},_.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:p,style:{width:s,height:i,top:a,left:r}}))}var Bu=N.memo(Lu);const Yu=e=>e.nodesSelectionActive,nr=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:d,selectionOnDrag:m,selectionMode:p,onSelectionStart:b,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:x,zoomActivationKeyCode:S,elementsSelectable:k,zoomOnScroll:w,zoomOnPinch:A,panOnScroll:M,panOnScrollSpeed:I,panOnScrollMode:V,zoomOnDoubleClick:T,panOnDrag:z,defaultViewport:H,translateExtent:F,minZoom:P,maxZoom:h,preventScrolling:C,onSelectionContextMenu:v,noWheelClassName:j,noPanClassName:R,disableKeyboardA11y:E})=>{const $=ee(Yu),D=Ct(d),O=Ct(x),B=O||z,L=O||M,Z=D||m&&B!==!0;return Au({deleteKeyCode:a,multiSelectionKeyCode:y}),_.createElement(zu,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:k,zoomOnScroll:w,zoomOnPinch:A,panOnScroll:L,panOnScrollSpeed:I,panOnScrollMode:V,zoomOnDoubleClick:T,panOnDrag:!D&&B,defaultViewport:H,translateExtent:F,minZoom:P,maxZoom:h,zoomActivationKeyCode:S,preventScrolling:C,noWheelClassName:j,noPanClassName:R},_.createElement(Ks,{onSelectionStart:b,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:B,isSelecting:!!Z,selectionMode:p},e,$&&_.createElement(Bu,{onSelectionContextMenu:v,noPanClassName:R,disableKeyboardA11y:E})))};nr.displayName="FlowRenderer";var Xu=N.memo(nr);function Zu(e){return ee(N.useCallback(n=>e?Ts(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Uu(e){const t={input:xt(e.input||Os),default:xt(e.default||jn),output:xt(e.output||Ls),group:xt(e.group||Un)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=xt(e[i]||jn),s),n);return{...t,...o}}const Wu=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},Gu=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),or=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=ee(Gu,re),a=Zu(e.onlyRenderVisibleElements),c=N.useRef(),u=N.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(d=>{const m=d.map(p=>({id:p.target.getAttribute("data-id"),nodeElement:p.target,forceUpdate:!0}));i(m)});return c.current=l,l},[]);return N.useEffect(()=>()=>{c?.current?.disconnect()},[]),_.createElement("div",{className:"react-flow__nodes",style:Gn},a.map(l=>{let d=l.type||"default";e.nodeTypes[d]||(r?.("003",Ae.error003(d)),d="default");const m=e.nodeTypes[d]||e.nodeTypes.default,p=!!(l.draggable||t&&typeof l.draggable>"u"),b=!!(l.selectable||s&&typeof l.selectable>"u"),g=!!(l.connectable||n&&typeof l.connectable>"u"),y=!!(l.focusable||o&&typeof l.focusable>"u"),x=e.nodeExtent?Fn(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,S=x?.x??0,k=x?.y??0,w=Wu({x:S,y:k,width:l.width??0,height:l.height??0,origin:e.nodeOrigin});return _.createElement(m,{key:l.id,id:l.id,className:l.className,style:l.style,type:d,data:l.data,sourcePosition:l.sourcePosition||Y.Bottom,targetPosition:l.targetPosition||Y.Top,hidden:l.hidden,xPos:S,yPos:k,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:p,isSelectable:b,isConnectable:g,isFocusable:y,resizeObserver:u,dragHandle:l.dragHandle,zIndex:l[te]?.z??0,isParent:!!l[te]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!l[te]?.handleBounds})}))};or.displayName="NodeRenderer";var qu=N.memo(or);const Ku=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,Ju=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,Ho="react-flow__edgeupdater",Vo=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:a})=>_.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:ae([Ho,`${Ho}-${a}`]),cx:Ku(t,o,e),cy:Ju(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),Qu=()=>!0;var nt=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:m,labelBgStyle:p,labelBgPadding:b,labelBgBorderRadius:g,style:y,source:x,target:S,sourceX:k,sourceY:w,targetX:A,targetY:M,sourcePosition:I,targetPosition:V,elementsSelectable:T,hidden:z,sourceHandleId:H,targetHandleId:F,onContextMenu:P,onMouseEnter:h,onMouseMove:C,onMouseLeave:v,reconnectRadius:j,onReconnect:R,onReconnectStart:E,onReconnectEnd:$,markerEnd:D,markerStart:O,rfId:B,ariaLabel:L,isFocusable:Z,isReconnectable:U,pathOptions:G,interactionWidth:J,disableKeyboardA11y:K})=>{const q=N.useRef(null),[ie,oe]=N.useState(!1),[ue,ce]=N.useState(!1),ne=se(),fe=N.useMemo(()=>`url('#${Mn(O,B)}')`,[O,B]),Q=N.useMemo(()=>`url('#${Mn(D,B)}')`,[D,B]);if(z)return null;const X=le=>{const{edges:we,addSelectedEdges:Pe,unselectNodesAndEdges:He,multiSelectionActive:Je}=ne.getState(),be=we.find(Ve=>Ve.id===n);be&&(T&&(ne.setState({nodesSelectionActive:!1}),be.selected&&Je?(He({nodes:[],edges:[be]}),q.current?.blur()):Pe([n])),r&&r(le,be))},de=pt(n,ne.getState,a),Ne=pt(n,ne.getState,P),ut=pt(n,ne.getState,h),Ue=pt(n,ne.getState,C),We=pt(n,ne.getState,v),Ee=(le,we)=>{if(le.button!==0)return;const{edges:Pe,isValidConnection:He}=ne.getState(),Je=we?S:x,be=(we?F:H)||null,Ve=we?"target":"source",en=He||Qu,tn=we,ft=Pe.find(Oe=>Oe.id===n);ce(!0),E?.(le,ft,Ve);const nn=Oe=>{ce(!1),$?.(Oe,ft,Ve)};Rs({event:le,handleId:be,nodeId:Je,onConnect:Oe=>R?.(ft,Oe),isTarget:tn,getState:ne.getState,setState:ne.setState,isValidConnection:en,edgeUpdaterType:Ve,onReconnectEnd:nn})},Ge=le=>Ee(le,!0),De=le=>Ee(le,!1),Re=()=>oe(!0),qe=()=>oe(!1),Ke=!T&&!r,dt=le=>{if(!K&&Ss.includes(le.key)&&T){const{unselectNodesAndEdges:we,addSelectedEdges:Pe,edges:He}=ne.getState();le.key==="Escape"?(q.current?.blur(),we({edges:[He.find(be=>be.id===n)]})):Pe([n])}};return _.createElement("g",{className:ae(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:c,animated:u,inactive:Ke,updating:ie}]),onClick:X,onDoubleClick:de,onContextMenu:Ne,onMouseEnter:ut,onMouseMove:Ue,onMouseLeave:We,onKeyDown:Z?dt:void 0,tabIndex:Z?0:void 0,role:Z?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":L===null?void 0:L||`Edge from ${x} to ${S}`,"aria-describedby":Z?`${Xs}-${B}`:void 0,ref:q},!ue&&_.createElement(e,{id:n,source:x,target:S,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:m,labelBgStyle:p,labelBgPadding:b,labelBgBorderRadius:g,data:i,style:y,sourceX:k,sourceY:w,targetX:A,targetY:M,sourcePosition:I,targetPosition:V,sourceHandleId:H,targetHandleId:F,markerStart:fe,markerEnd:Q,pathOptions:G,interactionWidth:J}),U&&_.createElement(_.Fragment,null,(U==="source"||U===!0)&&_.createElement(Vo,{position:I,centerX:k,centerY:w,radius:j,onMouseDown:Ge,onMouseEnter:Re,onMouseOut:qe,type:"source"}),(U==="target"||U===!0)&&_.createElement(Vo,{position:V,centerX:A,centerY:M,radius:j,onMouseDown:De,onMouseEnter:Re,onMouseOut:qe,type:"target"})))};return t.displayName="EdgeWrapper",N.memo(t)};function ed(e){const t={default:nt(e.default||Zt),straight:nt(e.bezier||Yn),step:nt(e.step||Bn),smoothstep:nt(e.step||Jt),simplebezier:nt(e.simplebezier||Ln)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=nt(e[i]||Zt),s),n);return{...t,...o}}function Oo(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,i=n?.width||t.width,r=n?.height||t.height;switch(e){case Y.Top:return{x:o+i/2,y:s};case Y.Right:return{x:o+i,y:s+r/2};case Y.Bottom:return{x:o+i/2,y:s+r};case Y.Left:return{x:o,y:s+r/2}}}function Fo(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const td=(e,t,n,o,s,i)=>{const r=Oo(n,e,t),a=Oo(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:a.x,targetY:a.y}};function nd({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=Et({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:r/c[2],height:a/c[2]}),d=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),m=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(d*m)>0}function Lo(e){const t=e?.[te]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const od=[{level:0,isMaxLevel:!0,edges:[]}];function sd(e,t,n=!1){let o=-1;const s=e.reduce((r,a)=>{const c=pe(a.zIndex);let u=c?a.zIndex:0;if(n){const l=t.get(a.target),d=t.get(a.source),m=a.selected||l?.selected||d?.selected,p=Math.max(d?.[te]?.z||0,l?.[te]?.z||0,1e3);u=(c?a.zIndex:0)+(m?p:0)}return r[u]?r[u].push(a):r[u]=[a],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,a])=>{const c=+r;return{edges:a,level:c,isMaxLevel:c===o}});return i.length===0?od:i}function rd(e,t,n){const o=ee(N.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),a=t.get(i.target);return r?.width&&r?.height&&a?.width&&a?.height&&nd({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:a.width,targetHeight:a.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return sd(o,t,n)}const id=({color:e="none",strokeWidth:t=1})=>_.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ad=({color:e="none",strokeWidth:t=1})=>_.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Bo={[_t.Arrow]:id,[_t.ArrowClosed]:ad};function cd(e){const t=se();return N.useMemo(()=>Object.prototype.hasOwnProperty.call(Bo,e)?Bo[e]:(t.getState().onError?.("009",Ae.error009(e)),null),[e])}const ld=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:a="auto-start-reverse"})=>{const c=cd(t);return c?_.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},_.createElement(c,{color:n,strokeWidth:r})):null},ud=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const a=Mn(r,t);o.includes(a)||(s.push({id:a,color:r.color||e,...r}),o.push(a))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},sr=({defaultColor:e,rfId:t})=>{const n=ee(N.useCallback(ud({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return _.createElement("defs",null,n.map(o=>_.createElement(ld,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};sr.displayName="MarkerDefinitions";var dd=N.memo(sr);const fd=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),rr=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:r,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:d,onReconnect:m,onReconnectStart:p,onReconnectEnd:b,reconnectRadius:g,children:y,disableKeyboardA11y:x})=>{const{edgesFocusable:S,edgesUpdatable:k,elementsSelectable:w,width:A,height:M,connectionMode:I,nodeInternals:V,onError:T}=ee(fd,re),z=rd(t,V,n);return A?_.createElement(_.Fragment,null,z.map(({level:H,edges:F,isMaxLevel:P})=>_.createElement("svg",{key:H,style:{zIndex:H},width:A,height:M,className:"react-flow__edges react-flow__container"},P&&_.createElement(dd,{defaultColor:e,rfId:o}),_.createElement("g",null,F.map(h=>{const[C,v,j]=Lo(V.get(h.source)),[R,E,$]=Lo(V.get(h.target));if(!j||!$)return null;let D=h.type||"default";s[D]||(T?.("011",Ae.error011(D)),D="default");const O=s[D]||s.default,B=I===Ze.Strict?E.target:(E.target??[]).concat(E.source??[]),L=Fo(v.source,h.sourceHandle),Z=Fo(B,h.targetHandle),U=L?.position||Y.Bottom,G=Z?.position||Y.Top,J=!!(h.focusable||S&&typeof h.focusable>"u"),K=h.reconnectable||h.updatable,q=typeof m<"u"&&(K||k&&typeof K>"u");if(!L||!Z)return T?.("008",Ae.error008(L,h)),null;const{sourceX:ie,sourceY:oe,targetX:ue,targetY:ce}=td(C,L,U,R,Z,G);return _.createElement(O,{key:h.id,id:h.id,className:ae([h.className,i]),type:D,data:h.data,selected:!!h.selected,animated:!!h.animated,hidden:!!h.hidden,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,style:h.style,source:h.source,target:h.target,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerEnd:h.markerEnd,markerStart:h.markerStart,sourceX:ie,sourceY:oe,targetX:ue,targetY:ce,sourcePosition:U,targetPosition:G,elementsSelectable:w,onContextMenu:r,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:d,onReconnect:m,onReconnectStart:p,onReconnectEnd:b,reconnectRadius:g,rfId:o,ariaLabel:h.ariaLabel,isFocusable:J,isReconnectable:q,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth,disableKeyboardA11y:x})})))),y):null};rr.displayName="EdgeRenderer";var hd=N.memo(rr);const md=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function pd({children:e}){const t=ee(md);return _.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function gd(e){const t=Wn(),n=N.useRef(!1);N.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const xd={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top},ir=({nodeId:e,handleType:t,style:n,type:o=_e.Bezier,CustomComponent:s,connectionStatus:i})=>{const{fromNode:r,handleId:a,toX:c,toY:u,connectionMode:l}=ee(N.useCallback(M=>({fromNode:M.nodeInternals.get(e),handleId:M.connectionHandleId,toX:(M.connectionPosition.x-M.transform[0])/M.transform[2],toY:(M.connectionPosition.y-M.transform[1])/M.transform[2],connectionMode:M.connectionMode}),[e]),re),d=r?.[te]?.handleBounds;let m=d?.[t];if(l===Ze.Loose&&(m=m||d?.[t==="source"?"target":"source"]),!r||!m)return null;const p=a?m.find(M=>M.id===a):m[0],b=p?p.x+p.width/2:(r.width??0)/2,g=p?p.y+p.height/2:r.height??0,y=(r.positionAbsolute?.x??0)+b,x=(r.positionAbsolute?.y??0)+g,S=p?.position,k=S?xd[S]:null;if(!S||!k)return null;if(s)return _.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:p,fromX:y,fromY:x,toX:c,toY:u,fromPosition:S,toPosition:k,connectionStatus:i});let w="";const A={sourceX:y,sourceY:x,sourcePosition:S,targetX:c,targetY:u,targetPosition:k};return o===_e.Bezier?[w]=As(A):o===_e.Step?[w]=kn({...A,borderRadius:0}):o===_e.SmoothStep?[w]=kn(A):o===_e.SimpleBezier?[w]=Ms(A):w=`M${y},${x} ${c},${u}`,_.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:n})};ir.displayName="ConnectionLine";const yd=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function wd({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:a,height:c,connectionStatus:u}=ee(yd,re);return!(s&&i&&a&&r)?null:_.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},_.createElement("g",{className:ae(["react-flow__connection",u])},_.createElement(ir,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function Yo(e,t){return N.useRef(null),se(),N.useMemo(()=>t(e),[e])}const ar=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:p,onSelectionContextMenu:b,onSelectionStart:g,onSelectionEnd:y,connectionLineType:x,connectionLineStyle:S,connectionLineComponent:k,connectionLineContainerStyle:w,selectionKeyCode:A,selectionOnDrag:M,selectionMode:I,multiSelectionKeyCode:V,panActivationKeyCode:T,zoomActivationKeyCode:z,deleteKeyCode:H,onlyRenderVisibleElements:F,elementsSelectable:P,selectNodesOnDrag:h,defaultViewport:C,translateExtent:v,minZoom:j,maxZoom:R,preventScrolling:E,defaultMarkerColor:$,zoomOnScroll:D,zoomOnPinch:O,panOnScroll:B,panOnScrollSpeed:L,panOnScrollMode:Z,zoomOnDoubleClick:U,panOnDrag:G,onPaneClick:J,onPaneMouseEnter:K,onPaneMouseMove:q,onPaneMouseLeave:ie,onPaneScroll:oe,onPaneContextMenu:ue,onEdgeContextMenu:ce,onEdgeMouseEnter:ne,onEdgeMouseMove:fe,onEdgeMouseLeave:Q,onReconnect:X,onReconnectStart:de,onReconnectEnd:Ne,reconnectRadius:ut,noDragClassName:Ue,noWheelClassName:We,noPanClassName:Ee,elevateEdgesOnSelect:Ge,disableKeyboardA11y:De,nodeOrigin:Re,nodeExtent:qe,rfId:Ke})=>{const dt=Yo(e,Uu),le=Yo(t,ed);return gd(i),_.createElement(Xu,{onPaneClick:J,onPaneMouseEnter:K,onPaneMouseMove:q,onPaneMouseLeave:ie,onPaneContextMenu:ue,onPaneScroll:oe,deleteKeyCode:H,selectionKeyCode:A,selectionOnDrag:M,selectionMode:I,onSelectionStart:g,onSelectionEnd:y,multiSelectionKeyCode:V,panActivationKeyCode:T,zoomActivationKeyCode:z,elementsSelectable:P,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:D,zoomOnPinch:O,zoomOnDoubleClick:U,panOnScroll:B,panOnScrollSpeed:L,panOnScrollMode:Z,panOnDrag:G,defaultViewport:C,translateExtent:v,minZoom:j,maxZoom:R,onSelectionContextMenu:b,preventScrolling:E,noDragClassName:Ue,noWheelClassName:We,noPanClassName:Ee,disableKeyboardA11y:De},_.createElement(pd,null,_.createElement(hd,{edgeTypes:le,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:F,onEdgeContextMenu:ce,onEdgeMouseEnter:ne,onEdgeMouseMove:fe,onEdgeMouseLeave:Q,onReconnect:X,onReconnectStart:de,onReconnectEnd:Ne,reconnectRadius:ut,defaultMarkerColor:$,noPanClassName:Ee,elevateEdgesOnSelect:!!Ge,disableKeyboardA11y:De,rfId:Ke},_.createElement(wd,{style:S,type:x,component:k,containerStyle:w})),_.createElement("div",{className:"react-flow__edgelabel-renderer"}),_.createElement(qu,{nodeTypes:dt,onNodeClick:r,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:p,selectNodesOnDrag:h,onlyRenderVisibleElements:F,noPanClassName:Ee,noDragClassName:Ue,disableKeyboardA11y:De,nodeOrigin:Re,nodeExtent:qe,rfId:Ke})))};ar.displayName="GraphView";var bd=N.memo(ar);const $n=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],je={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:$n,nodeExtent:$n,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ze.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Wl,isValidConnection:void 0},vd=()=>Di((e,t)=>({...je,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:fn(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?fn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c?.querySelector(".react-flow__viewport");if(!l)return;const d=window.getComputedStyle(l),{m22:m}=new window.DOMMatrixReadOnly(d.transform),p=n.reduce((g,y)=>{const x=s.get(y.id);if(x?.hidden)s.set(x.id,{...x,[te]:{...x[te],handleBounds:void 0}});else if(x){const S=On(y.nodeElement);!!(S.width&&S.height&&(x.width!==S.width||x.height!==S.height||y.forceUpdate))&&(s.set(x.id,{...x,[te]:{...x[te],handleBounds:{source:Po(".source",y.nodeElement,m,u),target:Po(".target",y.nodeElement,m,u)}},...S}),g.push({id:x.id,type:"dimensions",dimensions:S}))}return g},[]);Us(s,u);const b=r||i&&!r&&Ws(t,{initial:!0,...a});e({nodeInternals:new Map(s),fitViewOnInitDone:b}),p?.length>0&&o?.(p)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(a=>{const c={id:a.id,type:"position",dragging:s};return o&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:a,elevateNodesOnSelect:c}=t();if(n?.length){if(i){const u=qs(n,a()),l=fn(u,s,r,c);e({nodeInternals:l})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,a=null;o?r=n.map(c=>Te(c,!0)):(r=ot(i(),n),a=ot(s,[])),Dt({changedNodes:r,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,a=null;o?r=n.map(c=>Te(c,!0)):(r=ot(s,n),a=ot(i(),[])),Dt({changedNodes:a,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),a=o||s,c=r.map(l=>(l.selected=!1,Te(l.id,!1))),u=a.map(l=>Te(l.id,!1));Dt({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(a=>a.selected).map(a=>Te(a.id,!1)),r=n.filter(a=>a.selected).map(a=>Te(a.id,!1));Dt({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Fn(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:a,translateExtent:c}=t();if(!r||!a||!n.x&&!n.y)return!1;const u=ke.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),l=[[0,0],[s,i]],d=r?.constrain()(u,l,c);return r.transform(a,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:je.connectionNodeId,connectionHandleId:je.connectionHandleId,connectionHandleType:je.connectionHandleType,connectionStatus:je.connectionStatus,connectionStartHandle:je.connectionStartHandle,connectionEndHandle:je.connectionEndHandle}),reset:()=>e({...je})}),Object.is),qn=({children:e})=>{const t=N.useRef(null);return t.current||(t.current=vd()),_.createElement(Fl,{value:t.current},e)};qn.displayName="ReactFlowProvider";const cr=({children:e})=>N.useContext(Kt)?_.createElement(_.Fragment,null,e):_.createElement(qn,null,e);cr.displayName="ReactFlowWrapper";const Nd={input:Os,default:jn,output:Ls,group:Un},Ed={default:Zt,straight:Yn,step:Bn,smoothstep:Jt,simplebezier:Ln},Sd=[0,0],_d=[15,15],Cd={x:0,y:0,zoom:1},kd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},lr=N.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=Nd,edgeTypes:r=Ed,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:d,onMoveEnd:m,onConnect:p,onConnectStart:b,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:x,onNodeMouseEnter:S,onNodeMouseMove:k,onNodeMouseLeave:w,onNodeContextMenu:A,onNodeDoubleClick:M,onNodeDragStart:I,onNodeDrag:V,onNodeDragStop:T,onNodesDelete:z,onEdgesDelete:H,onSelectionChange:F,onSelectionDragStart:P,onSelectionDrag:h,onSelectionDragStop:C,onSelectionContextMenu:v,onSelectionStart:j,onSelectionEnd:R,connectionMode:E=Ze.Strict,connectionLineType:$=_e.Bezier,connectionLineStyle:D,connectionLineComponent:O,connectionLineContainerStyle:B,deleteKeyCode:L="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:U=!1,selectionMode:G=St.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:K=Xt()?"Meta":"Control",zoomActivationKeyCode:q=Xt()?"Meta":"Control",snapToGrid:ie=!1,snapGrid:oe=_d,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:ce=!0,nodesDraggable:ne,nodesConnectable:fe,nodesFocusable:Q,nodeOrigin:X=Sd,edgesFocusable:de,edgesUpdatable:Ne,elementsSelectable:ut,defaultViewport:Ue=Cd,minZoom:We=.5,maxZoom:Ee=2,translateExtent:Ge=$n,preventScrolling:De=!0,nodeExtent:Re,defaultMarkerColor:qe="#b1b1b7",zoomOnScroll:Ke=!0,zoomOnPinch:dt=!0,panOnScroll:le=!1,panOnScrollSpeed:we=.5,panOnScrollMode:Pe=Be.Free,zoomOnDoubleClick:He=!0,panOnDrag:Je=!0,onPaneClick:be,onPaneMouseEnter:Ve,onPaneMouseMove:en,onPaneMouseLeave:tn,onPaneScroll:ft,onPaneContextMenu:nn,children:Kn,onEdgeContextMenu:Oe,onEdgeDoubleClick:pr,onEdgeMouseEnter:gr,onEdgeMouseMove:xr,onEdgeMouseLeave:yr,onEdgeUpdate:wr,onEdgeUpdateStart:br,onEdgeUpdateEnd:vr,onReconnect:Nr,onReconnectStart:Er,onReconnectEnd:Sr,reconnectRadius:_r=10,edgeUpdaterRadius:Cr=10,onNodesChange:kr,onEdgesChange:Mr,noDragClassName:Ar="nodrag",noWheelClassName:jr="nowheel",noPanClassName:Jn="nopan",fitView:Tr=!1,fitViewOptions:$r,connectOnClick:zr=!0,attributionPosition:Ir,proOptions:Dr,defaultEdgeOptions:Rr,elevateNodesOnSelect:Pr=!0,elevateEdgesOnSelect:Hr=!1,disableKeyboardA11y:Qn=!1,autoPanOnConnect:Vr=!0,autoPanOnNodeDrag:Or=!0,connectionRadius:Fr=20,isValidConnection:Lr,onError:Br,style:Yr,id:eo,nodeDragThreshold:Xr,...Zr},Ur)=>{const on=eo||"1";return _.createElement("div",{...Zr,style:{...Yr,...kd},ref:Ur,className:ae(["react-flow",s]),"data-testid":"rf__wrapper",id:eo},_.createElement(cr,null,_.createElement(bd,{onInit:u,onMove:l,onMoveStart:d,onMoveEnd:m,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:S,onNodeMouseMove:k,onNodeMouseLeave:w,onNodeContextMenu:A,onNodeDoubleClick:M,nodeTypes:i,edgeTypes:r,connectionLineType:$,connectionLineStyle:D,connectionLineComponent:O,connectionLineContainerStyle:B,selectionKeyCode:Z,selectionOnDrag:U,selectionMode:G,deleteKeyCode:L,multiSelectionKeyCode:K,panActivationKeyCode:J,zoomActivationKeyCode:q,onlyRenderVisibleElements:ue,selectNodesOnDrag:ce,defaultViewport:Ue,translateExtent:Ge,minZoom:We,maxZoom:Ee,preventScrolling:De,zoomOnScroll:Ke,zoomOnPinch:dt,zoomOnDoubleClick:He,panOnScroll:le,panOnScrollSpeed:we,panOnScrollMode:Pe,panOnDrag:Je,onPaneClick:be,onPaneMouseEnter:Ve,onPaneMouseMove:en,onPaneMouseLeave:tn,onPaneScroll:ft,onPaneContextMenu:nn,onSelectionContextMenu:v,onSelectionStart:j,onSelectionEnd:R,onEdgeContextMenu:Oe,onEdgeDoubleClick:pr,onEdgeMouseEnter:gr,onEdgeMouseMove:xr,onEdgeMouseLeave:yr,onReconnect:Nr??wr,onReconnectStart:Er??br,onReconnectEnd:Sr??vr,reconnectRadius:_r??Cr,defaultMarkerColor:qe,noDragClassName:Ar,noWheelClassName:jr,noPanClassName:Jn,elevateEdgesOnSelect:Hr,rfId:on,disableKeyboardA11y:Qn,nodeOrigin:X,nodeExtent:Re}),_.createElement(xu,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:p,onConnectStart:b,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:x,nodesDraggable:ne,nodesConnectable:fe,nodesFocusable:Q,edgesFocusable:de,edgesUpdatable:Ne,elementsSelectable:ut,elevateNodesOnSelect:Pr,minZoom:We,maxZoom:Ee,nodeExtent:Re,onNodesChange:kr,onEdgesChange:Mr,snapToGrid:ie,snapGrid:oe,connectionMode:E,translateExtent:Ge,connectOnClick:zr,defaultEdgeOptions:Rr,fitView:Tr,fitViewOptions:$r,onNodesDelete:z,onEdgesDelete:H,onNodeDragStart:I,onNodeDrag:V,onNodeDragStop:T,onSelectionDrag:h,onSelectionDragStart:P,onSelectionDragStop:C,noPanClassName:Jn,nodeOrigin:X,rfId:on,autoPanOnConnect:Vr,autoPanOnNodeDrag:Or,onError:Br,connectionRadius:Fr,isValidConnection:Lr,nodeDragThreshold:Xr}),_.createElement(pu,{onSelectionChange:F}),Kn,_.createElement(Bl,{proOptions:Dr,position:Ir}),_.createElement(Nu,{rfId:on,disableKeyboardA11y:Qn})))});lr.displayName="ReactFlow";function ur(e){return t=>{const[n,o]=N.useState(t),s=N.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Md=ur(qs),Ad=ur(Ru),dr=({id:e,x:t,y:n,width:o,height:s,style:i,color:r,strokeColor:a,strokeWidth:c,className:u,borderRadius:l,shapeRendering:d,onClick:m,selected:p})=>{const{background:b,backgroundColor:g}=i||{},y=r||b||g;return _.createElement("rect",{className:ae(["react-flow__minimap-node",{selected:p},u]),x:t,y:n,rx:l,ry:l,width:o,height:s,fill:y,stroke:a,strokeWidth:c,shapeRendering:d,onClick:m?x=>m(x,e):void 0})};dr.displayName="MiniMapNode";var jd=N.memo(dr);const Td=e=>e.nodeOrigin,$d=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),gn=e=>e instanceof Function?e:()=>e;function zd({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:i=jd,onClick:r}){const a=ee($d,re),c=ee(Td),u=gn(t),l=gn(e),d=gn(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return _.createElement(_.Fragment,null,a.map(p=>{const{x:b,y:g}=Ye(p,c).positionAbsolute;return _.createElement(i,{key:p.id,x:b,y:g,width:p.width,height:p.height,style:p.style,selected:p.selected,className:d(p),color:u(p),borderRadius:o,strokeColor:l(p),strokeWidth:s,shapeRendering:m,onClick:r,id:p.id})}))}var Id=N.memo(zd);const Dd=200,Rd=150,Pd=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Zl(Qt(t,e.nodeOrigin),n):n,rfId:e.rfId}},Hd="react-flow__minimap-desc";function fr({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:r=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:l=1,position:d="bottom-right",onClick:m,onNodeClick:p,pannable:b=!1,zoomable:g=!1,ariaLabel:y="React Flow mini map",inversePan:x=!1,zoomStep:S=10,offsetScale:k=5}){const w=se(),A=N.useRef(null),{boundingRect:M,viewBB:I,rfId:V}=ee(Pd,re),T=e?.width??Dd,z=e?.height??Rd,H=M.width/T,F=M.height/z,P=Math.max(H,F),h=P*T,C=P*z,v=k*P,j=M.x-(h-M.width)/2-v,R=M.y-(C-M.height)/2-v,E=h+v*2,$=C+v*2,D=`${Hd}-${V}`,O=N.useRef(0);O.current=P,N.useEffect(()=>{if(A.current){const Z=me(A.current),U=K=>{const{transform:q,d3Selection:ie,d3Zoom:oe}=w.getState();if(K.sourceEvent.type!=="wheel"||!ie||!oe)return;const ue=-K.sourceEvent.deltaY*(K.sourceEvent.deltaMode===1?.05:K.sourceEvent.deltaMode?1:.002)*S,ce=q[2]*Math.pow(2,ue);oe.scaleTo(ie,ce)},G=K=>{const{transform:q,d3Selection:ie,d3Zoom:oe,translateExtent:ue,width:ce,height:ne}=w.getState();if(K.sourceEvent.type!=="mousemove"||!ie||!oe)return;const fe=O.current*Math.max(1,q[2])*(x?-1:1),Q={x:q[0]-K.sourceEvent.movementX*fe,y:q[1]-K.sourceEvent.movementY*fe},X=[[0,0],[ce,ne]],de=ke.translate(Q.x,Q.y).scale(q[2]),Ne=oe.constrain()(de,X,ue);oe.transform(ie,Ne)},J=ys().on("zoom",b?G:null).on("zoom.wheel",g?U:null);return Z.call(J),()=>{Z.on("zoom",null)}}},[b,g,x,S]);const B=m?Z=>{const U=xe(Z);m(Z,{x:U[0],y:U[1]})}:void 0,L=p?(Z,U)=>{const G=w.getState().nodeInternals.get(U);p(Z,G)}:void 0;return _.createElement(Vn,{position:d,style:e,className:ae(["react-flow__minimap",t]),"data-testid":"rf__minimap"},_.createElement("svg",{width:T,height:z,viewBox:`${j} ${R} ${E} ${$}`,role:"img","aria-labelledby":D,ref:A,onClick:B},y&&_.createElement("title",{id:D},y),_.createElement(Id,{onClick:L,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:r,nodeComponent:a}),_.createElement("path",{className:"react-flow__minimap-mask",d:`M${j-v},${R-v}h${E+v*2}v${$+v*2}h${-E-v*2}z
        M${I.x},${I.y}h${I.width}v${I.height}h${-I.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:l,pointerEvents:"none"})))}fr.displayName="MiniMap";var Vd=N.memo(fr);function Od(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},_.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Fd(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},_.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Ld(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},_.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Bd(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Yd(){return _.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const bt=({children:e,className:t,...n})=>_.createElement("button",{type:"button",className:ae(["react-flow__controls-button",t]),...n},e);bt.displayName="ControlButton";const Xd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),hr=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:r,onFitView:a,onInteractiveChange:c,className:u,children:l,position:d="bottom-left"})=>{const m=se(),[p,b]=N.useState(!1),{isInteractive:g,minZoomReached:y,maxZoomReached:x}=ee(Xd,re),{zoomIn:S,zoomOut:k,fitView:w}=Wn();if(N.useEffect(()=>{b(!0)},[]),!p)return null;const A=()=>{S(),i?.()},M=()=>{k(),r?.()},I=()=>{w(s),a?.()},V=()=>{m.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),c?.(!g)};return _.createElement(Vn,{className:ae(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&_.createElement(_.Fragment,null,_.createElement(bt,{onClick:A,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},_.createElement(Od,null)),_.createElement(bt,{onClick:M,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},_.createElement(Fd,null))),n&&_.createElement(bt,{className:"react-flow__controls-fitview",onClick:I,title:"fit view","aria-label":"fit view"},_.createElement(Ld,null)),o&&_.createElement(bt,{className:"react-flow__controls-interactive",onClick:V,title:"toggle interactivity","aria-label":"toggle interactivity"},g?_.createElement(Yd,null):_.createElement(Bd,null)),l)};hr.displayName="Controls";var Zd=N.memo(hr),ge;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ge||(ge={}));function Ud({color:e,dimensions:t,lineWidth:n}){return _.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Wd({color:e,radius:t}){return _.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Gd={[ge.Dots]:"#91919a",[ge.Lines]:"#eee",[ge.Cross]:"#e2e2e2"},qd={[ge.Dots]:1,[ge.Lines]:1,[ge.Cross]:6},Kd=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function mr({id:e,variant:t=ge.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:a,className:c}){const u=N.useRef(null),{transform:l,patternId:d}=ee(Kd,re),m=r||Gd[t],p=o||qd[t],b=t===ge.Dots,g=t===ge.Cross,y=Array.isArray(n)?n:[n,n],x=[y[0]*l[2]||1,y[1]*l[2]||1],S=p*l[2],k=g?[S,S]:x,w=b?[S/i,S/i]:[k[0]/i,k[1]/i];return _.createElement("svg",{className:ae(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},_.createElement("pattern",{id:d+e,x:l[0]%x[0],y:l[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${w[0]},-${w[1]})`},b?_.createElement(Wd,{color:m,radius:S/i}):_.createElement(Ud,{dimensions:k,color:m,lineWidth:s})),_.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}mr.displayName="Background";var Jd=N.memo(mr);function Qd(e,t={}){const{backwardDepth:n=1,forwardDepth:o=1}=t,[s,i]=N.useState(null),[r,a]=N.useState(!0),[c,u]=N.useState(null),l=async()=>{try{a(!0),u(null);const d=await Gr.get(`/patents/${e}/citations/network`,{params:{backwardDepth:n,forwardDepth:o}});if(!d.data)throw new Error("No citation network data received");i(d.data)}catch(d){const m=d instanceof Error?d.message:"Failed to load citation network";u(m),console.error("Citation network fetch error:",d)}finally{a(!1)}};return N.useEffect(()=>{e&&l()},[e,n,o]),{data:s,isLoading:r,error:c,refetch:l}}function ef({data:e,id:t}){const n=zn(),[o,s]=N.useState(!1),i=()=>{if(e.isRoot){console.log(" Root node clicked - no navigation");return}if(!qr()){console.warn(" User not authenticated, redirecting to login"),alert("Your session has expired. Please log in again."),n("/login");return}console.log(" Navigating to patent:",t),n(`/patents/${t}`)},a=e.backwardCitationCount+e.forwardCitationCount>=10;return e.isRoot?f.jsxs(f.Fragment,{children:[f.jsx(ze,{type:"target",position:Y.Left}),f.jsxs("div",{className:"relative",style:{cursor:"default"},children:[f.jsx("div",{className:`
              rounded-full flex items-center justify-center text-white font-medium
              ${a?"shadow-lg":"shadow-md"}
              border-4 border-white
            `,style:{width:`${e.nodeSize}px`,height:`${e.nodeSize}px`,backgroundColor:e.nodeColor,fontSize:"12px",boxShadow:a?`0 0 20px ${e.nodeColor}80`:void 0},onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:f.jsx("span",{className:"font-bold",children:e.label})}),o&&f.jsx("div",{className:"absolute z-50 bg-white rounded-lg shadow-xl border-2 border-gray-200 p-4 min-w-[280px]",style:{top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"8px",pointerEvents:"none"},children:f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Patent:"}),f.jsx("span",{className:"text-gray-900",children:e.patentId})]}),e.title&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Title:"}),f.jsx("span",{className:"text-gray-700 line-clamp-2",children:e.title})]}),e.assignee&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Assignee:"}),f.jsx("span",{className:"text-gray-700",children:e.assignee})]}),e.grantDate&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Grant Date:"}),f.jsx("span",{className:"text-gray-700",children:e.grantDate})]}),f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Citations:"}),f.jsxs("span",{className:"text-gray-700",children:[e.backwardCitationCount," cited / ",e.forwardCitationCount," citing"]})]}),e.ipcClasses&&e.ipcClasses.length>0&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"IPC:"}),f.jsx("span",{className:"text-gray-700",children:e.ipcClasses[0]})]})]})})]}),f.jsx(ze,{type:"source",position:Y.Right})]}):f.jsxs(f.Fragment,{children:[f.jsx(ze,{type:"target",position:Y.Left}),f.jsxs("button",{type:"button",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onClick:i,className:"relative border-0 bg-transparent p-0 m-0",style:{cursor:"pointer"},"aria-label":`View patent ${e.patentId}`,children:[f.jsx("div",{className:`
            rounded-full flex items-center justify-center text-white font-medium
            ${a?"shadow-lg":"shadow-md"}
            border-2 border-gray-200
            transition-transform hover:scale-110
          `,style:{width:`${e.nodeSize}px`,height:`${e.nodeSize}px`,backgroundColor:e.nodeColor,fontSize:"10px",boxShadow:a?`0 0 20px ${e.nodeColor}80`:void 0}}),o&&f.jsx("div",{className:"absolute z-50 bg-white rounded-lg shadow-xl border-2 border-gray-200 p-4 min-w-[280px]",style:{top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"8px",pointerEvents:"none"},children:f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Patent:"}),f.jsx("span",{className:"text-gray-900",children:e.patentId})]}),e.title&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Title:"}),f.jsx("span",{className:"text-gray-700 line-clamp-2",children:e.title})]}),e.assignee&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Assignee:"}),f.jsx("span",{className:"text-gray-700",children:e.assignee})]}),e.grantDate&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Grant Date:"}),f.jsx("span",{className:"text-gray-700",children:e.grantDate})]}),f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"Citations:"}),f.jsxs("span",{className:"text-gray-700",children:[e.backwardCitationCount," cited / ",e.forwardCitationCount," citing"]})]}),e.ipcClasses&&e.ipcClasses.length>0&&f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{className:"font-bold text-blue-600 min-w-[60px]",children:"IPC:"}),f.jsx("span",{className:"text-gray-700",children:e.ipcClasses[0]})]}),f.jsx("div",{className:"pt-2 border-t border-gray-200 text-xs text-gray-500 italic text-center",children:"Click to view details"})]})})]}),f.jsx(ze,{type:"source",position:Y.Right})]})}function Xo({metrics:e,onClose:t}){const n=zn(),o=Object.entries(e.assigneeDistribution||{}).sort(([,a],[,c])=>c-a).slice(0,3),s=o.length>0?o[0][1]:1,i=Object.entries(e.technologyDistribution||{}).sort(([,a],[,c])=>c-a).slice(0,3),r=tf(e);return f.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 space-y-6 w-full max-w-sm",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[f.jsx(ri,{className:"w-5 h-5 text-blue-600"}),"Network Statistics"]}),t&&f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close panel",children:""})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[f.jsx("span",{className:"text-sm text-gray-700",children:"Total Patents"}),f.jsx("span",{className:"text-lg font-bold text-blue-600",children:e.totalNodes})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[f.jsx("span",{className:"text-sm text-gray-700",children:"Connections"}),f.jsx("span",{className:"text-lg font-bold text-green-600",children:e.totalEdges})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[f.jsx("span",{className:"text-sm text-gray-700",children:"Network Density"}),f.jsx("span",{className:"text-lg font-bold text-purple-600",children:e.citationDensity.toFixed(2)})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 bg-amber-50 rounded-lg",children:[f.jsx("span",{className:"text-sm text-gray-700",children:"Avg Citations"}),f.jsx("span",{className:"text-lg font-bold text-amber-600",children:e.averageCitationsPerPatent.toFixed(1)})]})]}),e.mostCitedPatent&&f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(yn,{className:"w-4 h-4 text-blue-600"}),f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Most Cited Patent"})]}),f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.mostCitedPatent}),f.jsxs("span",{className:"text-xs text-gray-600",children:["(",e.mostCitedCount," citations)"]})]}),f.jsx("button",{onClick:()=>n(`/patent/${e.mostCitedPatent}`),className:"text-xs text-blue-600 hover:text-blue-700 mt-1 flex items-center gap-1",children:"View patent "})]})]}),r.length>0&&f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.jsx(ai,{className:"w-4 h-4 text-amber-500"}),f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Key Insights"})]}),f.jsx("div",{className:"space-y-2",children:r.map(a=>f.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-600",children:[f.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),f.jsx("span",{children:a})]},a))})]}),o.length>0&&f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.jsx(ni,{className:"w-4 h-4 text-blue-600"}),f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Assignee Distribution"})]}),f.jsx("div",{className:"space-y-2",children:o.map(([a,c])=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[f.jsx("span",{className:"text-gray-700 truncate max-w-[180px]",children:a}),f.jsxs("span",{className:"text-gray-500",children:[c," patents"]})]}),f.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-blue-600 rounded-full",style:{width:`${c/s*100}%`}})})]},a))})]}),i.length>0&&f.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.jsx($e,{className:"w-4 h-4 text-blue-600"}),f.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Technology Areas (IPC)"})]}),f.jsx("div",{className:"space-y-2",children:i.map(([a,c])=>f.jsxs("div",{className:"flex justify-between items-center text-xs",children:[f.jsx("span",{className:"text-gray-700 font-medium",children:a}),f.jsxs("span",{className:"text-gray-500",children:["(",c,")"]})]},a))})]})]})}function tf(e){const t=[];return e.totalNodes>20&&t.push("Large citation network indicates significant prior art foundation"),e.citationDensity>.3&&t.push("High network density suggests interconnected technology area"),e.citationDensity<.1&&e.totalNodes>10&&t.push("Low density indicates diverse, loosely connected citations"),e.numberOfClusters&&e.numberOfClusters>2&&t.push(`${e.numberOfClusters} technology clusters identified - spans multiple technical areas`),Object.keys(e.assigneeDistribution||{}).length>5&&t.push("Citations span multiple companies and research institutions"),Math.max(...Object.values(e.assigneeDistribution||{}))>e.totalNodes*.5&&t.push("Citations dominated by single assignee - may indicate focused technology area"),t}function Zo(e,t,n={}){const{centerX:o=500,centerY:s=300,horizontalSpacing:i=400,verticalSpacing:r=80}=n,a=[],c=e.find(g=>g.patentId===t);if(!c)return[];const u=e.filter(g=>g.depth===1&&g.patentId!==t),l=e.filter(g=>g.depth===-1&&g.patentId!==t);a.push(xn(c,o,s,!0));const d=u.length,m=s-(d-1)*r/2;u.forEach((g,y)=>{const x=d===1?s:m+y*r;a.push(xn(g,o-i,x,!1))});const p=l.length,b=s-(p-1)*r/2;return l.forEach((g,y)=>{const x=p===1?s:b+y*r;a.push(xn(g,o+i,x,!1))}),a}function xn(e,t,n,o){return{id:e.patentId,type:"customPatentNode",data:{...e,label:e.patentId,isRoot:o},position:{x:t,y:n},draggable:!0,selectable:!0}}const nf={customPatentNode:ef};function of(e){return e.map((t,n)=>{const o=t.citationType?.toLowerCase().includes("examiner");return{id:`${t.source}-${t.target}-${n}`,source:t.source,target:t.target,type:_e.SmoothStep,animated:!1,style:{stroke:o?"#EF4444":"#3B82F6",strokeWidth:2,opacity:.6},markerEnd:{type:_t.ArrowClosed,color:o?"#EF4444":"#3B82F6",width:20,height:20},label:t.citationType,labelStyle:{fontSize:10,fill:o?"#DC2626":"#2563EB",fontWeight:500},labelBgStyle:{fill:"#FFFFFF",fillOpacity:.8,rx:4,ry:4}}})}function sf({patentId:e,source:t,currentPatentTitle:n,data:o,isLoading:s,error:i,refetch:r}){const[a,c,u]=Md([]),[l,d,m]=Ad([]),[p,b]=N.useState(!0),[g,y]=N.useState(!0),x=t==="PATENTSVIEW";N.useMemo(()=>{if(!o||!o.nodes||o.nodes.length===0){c([]),d([]);return}console.log(" Citation Network Data Received:",{totalNodes:o.nodes.length,totalEdges:o.edges.length,nodes:o.nodes.map(h=>({id:h.id,title:h.title,isRoot:h.isRoot})),edges:o.edges.map(h=>({source:h.source,target:h.target,type:h.citationType})),metrics:o.metrics});const z=new Set(o.nodes.map(h=>h.id)),H=o.edges.filter(h=>!z.has(h.source)||!z.has(h.target));H.length>0&&console.warn(" Found edges with missing nodes:",H);const F=Zo(o.nodes,e),P=of(o.edges);console.log(" Visualization ready:",{layoutedNodes:F.length,flowEdges:P.length}),c(F),d(P)},[o,e]);const S=N.useCallback(()=>{},[]),k=N.useCallback(()=>{},[]),w=N.useCallback(()=>{},[]),A=N.useCallback(()=>{if(o&&o.nodes){const z=Zo(o.nodes,e);c(z)}},[o,e]),M=N.useCallback(()=>{if(o){const z={patent:e,nodes:o.nodes,edges:o.edges,metrics:o.metrics,exportedAt:new Date().toISOString()},H=new Blob([JSON.stringify(z,null,2)],{type:"application/json"}),F=URL.createObjectURL(H),P=document.createElement("a");P.href=F,P.download=`patent-${e}-citations.json`,P.click(),URL.revokeObjectURL(F)}},[o,e]);if(!x)return f.jsxs("div",{className:"bg-blue-50/50 backdrop-blur-xl rounded-2xl p-8 border border-blue-200/50 shadow-xl",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-blue-900 mb-4 flex items-center gap-2",children:[f.jsx($e,{className:"w-6 h-6"}),"Citation Network (US patents only)"]}),f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-100 border border-blue-300 rounded-lg",children:[f.jsx(At,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),f.jsx("p",{className:"text-blue-800 text-sm",children:"Citation network is currently available only for US patents from PatentsView API."})]})]});if(s)return f.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-8 border border-blue-200/50 shadow-xl",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-blue-900 mb-4 flex items-center gap-2",children:[f.jsx($e,{className:"w-6 h-6"}),"Citation Network"]}),f.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[f.jsx(Kr,{className:"w-12 h-12 text-blue-600 animate-spin"}),f.jsx("p",{className:"text-gray-600 text-sm",children:"Loading citation network..."}),f.jsx("p",{className:"text-gray-500 text-xs",children:"Fetching citations from PatentsView API"}),f.jsx("p",{className:"text-gray-400 text-xs",children:"This may take a few seconds"})]})]});if(i)return f.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-8 border border-red-200/50 shadow-xl",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-blue-900 mb-4 flex items-center gap-2",children:[f.jsx($e,{className:"w-6 h-6"}),"Citation Network"]}),f.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-300 rounded-lg",children:[f.jsx(At,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-red-800 font-medium",children:"Failed to load citation network"}),f.jsx("p",{className:"text-red-600 text-sm mt-1",children:i})]})]}),f.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Retry"})]})]});if(!o||!o.nodes||o.nodes.length===0)return f.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-8 border border-blue-200/50 shadow-xl",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-blue-900 mb-4 flex items-center gap-2",children:[f.jsx($e,{className:"w-6 h-6"}),"Citation Network (Experimental)"]}),f.jsxs("div",{className:"flex items-start gap-3 p-4 bg-slate-100 border border-slate-300 rounded-lg",children:[f.jsx(At,{className:"w-5 h-5 text-slate-600 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-slate-700 text-sm font-medium",children:"No citation data available"}),f.jsx("p",{className:"text-slate-600 text-xs mt-1",children:"This is normal for newly granted patents or patents not yet in the PatentsView database. Citation data availability varies by patent age and jurisdiction."})]})]})]});const I=o.nodes.filter(z=>z.depth===1).length,V=o.nodes.filter(z=>z.depth===-1).length,T=V>0;return f.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-8 border border-blue-200/50 shadow-xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-blue-900 flex items-center gap-2",children:[f.jsx($e,{className:"w-6 h-6"}),"Citation Network (Experimental)"]}),f.jsxs("button",{onClick:()=>y(!g),className:"lg:hidden px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm flex items-center gap-2",children:[g?f.jsx(oo,{className:"w-4 h-4"}):f.jsx(so,{className:"w-4 h-4"}),g?"Hide":"Show"," Stats"]})]}),f.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:f.jsxs("p",{className:"text-xs text-amber-800",children:[f.jsx("strong",{children:"Limited depth for performance:"})," Showing direct citations only (depth 1)  US patents only"]})}),f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"flex-1 space-y-4",children:[f.jsxs("div",{className:"flex gap-4 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-slate-100 rounded-lg",children:[f.jsx("span",{className:"text-sm text-slate-600",children:"Backward Citations:"}),f.jsx("span",{className:"font-bold text-slate-900",children:I})]}),f.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 rounded-lg",children:[f.jsx("span",{className:"text-sm text-green-600",children:"Forward Citations:"}),f.jsx("span",{className:"font-bold text-green-900",children:V})]}),!T&&f.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 rounded-lg",children:[f.jsx(At,{className:"w-4 h-4 text-amber-600"}),f.jsx("span",{className:"text-xs text-amber-700",children:"No forward citations - patent not yet cited by later patents"})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-6 text-xs text-slate-600 bg-slate-50 p-4 rounded-lg",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"font-semibold text-slate-700 mb-2",children:"Node Types:"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 bg-slate-400 border-2 border-slate-600 rounded-full"}),f.jsx("span",{children:"Prior Art (Left)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 bg-blue-500 border-4 border-white rounded-full shadow-md"}),f.jsx("span",{children:"Current Patent (Center)"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 bg-green-500 border-2 border-green-700 rounded-full"}),f.jsx("span",{children:"Later Patents (Right)"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"font-semibold text-slate-700 mb-2",children:"Edge Types:"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-0.5 bg-red-500"}),f.jsx("span",{children:"Examiner Citations"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-0.5 bg-blue-500"}),f.jsx("span",{children:"Applicant Citations"})]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("button",{onClick:S,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-2",title:"Zoom In",children:[f.jsx(hi,{className:"w-4 h-4"}),"Zoom In"]}),f.jsxs("button",{onClick:k,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-2",title:"Zoom Out",children:[f.jsx(pi,{className:"w-4 h-4"}),"Zoom Out"]}),f.jsxs("button",{onClick:w,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-2",title:"Fit View",children:[f.jsx(li,{className:"w-4 h-4"}),"Fit View"]}),f.jsxs("button",{onClick:A,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-2",title:"Reset Layout",children:[f.jsx(di,{className:"w-4 h-4"}),"Reset"]}),f.jsxs("button",{onClick:()=>b(!p),className:"px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm flex items-center gap-2",title:"Toggle Labels",children:[p?f.jsx(oo,{className:"w-4 h-4"}):f.jsx(so,{className:"w-4 h-4"}),p?"Hide":"Show"," Labels"]}),f.jsxs("button",{onClick:M,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center gap-2",title:"Export as JSON",children:[f.jsx(oi,{className:"w-4 h-4"}),"Export JSON"]})]}),f.jsx("div",{className:"bg-white rounded-lg border border-slate-200 shadow-inner relative",style:{width:"100%",height:"600px"},children:f.jsxs(lr,{nodes:a,edges:l,onNodesChange:u,onEdgesChange:m,nodeTypes:nf,fitView:!0,fitViewOptions:{padding:.2,includeHiddenNodes:!1,minZoom:.5,maxZoom:1.5},attributionPosition:"bottom-left",proOptions:{hideAttribution:!0},nodesDraggable:!0,nodesConnectable:!1,elementsSelectable:!0,minZoom:.2,maxZoom:3,children:[f.jsx(Jd,{variant:ge.Dots,gap:16,size:1,color:"#E5E7EB"}),f.jsx(Zd,{className:"bg-white border border-slate-200 rounded-lg shadow-lg"}),f.jsx(Vd,{className:"bg-white border border-slate-200 rounded-lg shadow-lg",nodeColor:z=>{const H=z.data;return H?.isRoot?"#3B82F6":H?.depth===1?"#94A3B8":"#10B981"},maskColor:"rgba(0, 0, 0, 0.1)"})]})}),f.jsxs("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-700 mb-3 font-medium",children:"Interactive citation network visualization"}),f.jsxs("ul",{className:"text-xs text-slate-600 space-y-1.5 list-disc list-inside",children:[f.jsx("li",{children:"Hover over nodes to see patent details"}),f.jsx("li",{children:"Click on citation nodes to view that patent's details"}),f.jsx("li",{children:"Drag nodes to reposition them"}),f.jsx("li",{children:"Use mouse wheel to zoom in/out"}),f.jsx("li",{children:"Arrow direction shows citing  cited relationship"})]})]})]}),g&&f.jsx("div",{className:"hidden lg:block w-96",children:f.jsx(Xo,{metrics:o.metrics,onClose:()=>y(!1)})})]}),g&&f.jsx("div",{className:"lg:hidden mt-6",children:f.jsx(Xo,{metrics:o.metrics,onClose:()=>y(!1)})})]})}function rf(e){const{data:t,isLoading:n,error:o,refetch:s}=Qd(e.patentId);return f.jsx(qn,{children:f.jsx(sf,{...e,data:t,isLoading:n,error:o,refetch:s})})}function Nf(){const[e]=Jr(),t=zn(),[n,o]=N.useState("home"),[s,i]=N.useState(null);N.useEffect(()=>{const a=e.get("view"),c=e.get("patentId");a&&o(a),c&&i(c)},[e]);const r=a=>{o(a),t(`/analyst/visualization?view=${a}`)};return f.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100",children:[f.jsx(Qr,{userName:"Analyst"}),f.jsxs("div",{className:"flex",children:[f.jsx(ei,{}),f.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:f.jsxs("div",{className:"max-w-7xl mx-auto",children:[f.jsxs("div",{className:"mb-8",children:[f.jsx("h1",{className:"text-4xl font-bold text-blue-900 mb-2",children:"Visualization Engine"}),f.jsx("p",{className:"text-slate-600",children:"Explore patent data through interactive visualizations"})]}),n==="home"&&f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsx("button",{onClick:()=>r("citations"),className:"bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all text-left border-2 border-transparent hover:border-blue-400",children:f.jsxs("div",{className:"flex flex-col items-center justify-center h-48",children:[f.jsx($e,{className:"w-16 h-16 text-blue-600 mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-blue-900 mb-2",children:"Citation Network"}),f.jsx("span",{className:"text-xs text-amber-600 font-medium mb-2",children:"Experimental"}),f.jsx("p",{className:"text-sm text-slate-600 text-center",children:"Direct citations only (depth 1)  US patents"})]})}),f.jsx("button",{onClick:()=>r("trends"),className:"bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all text-left border-2 border-transparent hover:border-blue-400",children:f.jsxs("div",{className:"flex flex-col items-center justify-center h-48",children:[f.jsx(yn,{className:"w-16 h-16 text-green-600 mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-blue-900 mb-2",children:"Filing Trends"}),f.jsx("p",{className:"text-sm text-slate-600 text-center",children:"Patent filings over time"})]})}),f.jsx("button",{onClick:()=>r("geography"),className:"bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all text-left border-2 border-transparent hover:border-blue-400",children:f.jsxs("div",{className:"flex flex-col items-center justify-center h-48",children:[f.jsx(ro,{className:"w-16 h-16 text-purple-600 mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-blue-900 mb-2",children:"Geographic Distribution"}),f.jsx("p",{className:"text-sm text-slate-600 text-center",children:"Filings by country"})]})})]}),n==="citations"&&s&&f.jsxs("div",{children:[f.jsx("button",{onClick:()=>r("home"),className:"mb-6 px-4 py-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-all",children:" Back to Visualizations"}),f.jsx(rf,{patentId:s,source:"PATENTSVIEW"})]}),n==="citations"&&!s&&f.jsxs("div",{className:"bg-white rounded-2xl p-12 shadow-lg text-center",children:[f.jsx($e,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-2",children:"Citation Network (Experimental)"}),f.jsx("p",{className:"text-slate-600 mb-6",children:'Navigate to a patent detail page and click "View Citation Network" to explore citations.'}),f.jsx("button",{onClick:()=>r("home"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all",children:"Back to Home"})]}),n==="trends"&&f.jsxs("div",{className:"bg-white rounded-2xl p-12 shadow-lg text-center",children:[f.jsx(yn,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-2",children:"Filing Trends Over Time"}),f.jsx("p",{className:"text-slate-600 mb-4",children:"Coming soon: Line and bar charts showing patent filing patterns over time."}),f.jsx("button",{onClick:()=>r("home"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all",children:"Back to Home"})]}),n==="geography"&&f.jsxs("div",{className:"bg-white rounded-2xl p-12 shadow-lg text-center",children:[f.jsx(ro,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-2",children:"Geographic Filing Distribution"}),f.jsx("p",{className:"text-slate-600 mb-4",children:"Coming soon: Map and charts showing patent filings by country."}),f.jsx("button",{onClick:()=>r("home"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all",children:"Back to Home"})]})]})})]})]})}export{Nf as VisualizationEnginePage};
