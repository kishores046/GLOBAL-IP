import{l as E,j as e,b as A,r as h}from"./index-BbdKGyFO.js";import{B as g}from"./button-CjtP1QU6.js";import{C as x,a as y,b as f,c as b,d as F}from"./index-COpZ8R9a.js";import{A as k,a as S}from"./alert-9Xmo6138.js";import{X as N}from"./x-BD8jR-FZ.js";import{C as T}from"./circle-alert-DdFSup5D.js";import{D as I}from"./download-5qXpfTS0.js";import"./clsx-B-dksMZM.js";const L="http://localhost:8080/api/trends/trademarks",m=E.create({baseURL:L,headers:{"Content-Type":"application/json"}});m.interceptors.request.use(s=>{const a=localStorage.getItem("jwt_token");return a&&(s.headers.Authorization=`Bearer ${a}`),s},s=>Promise.reject(s));m.interceptors.response.use(s=>s,s=>{throw console.error("Trademark trend API error:",s.response?.data||s.message),s});const p=new Map,P=600*1e3,w=(s,a)=>`trademark:${s}:${JSON.stringify(a||{})}`,M=s=>{const a=p.get(s);return a?Date.now()-a.timestamp<a.ttl:!1},C=s=>M(s)?p.get(s)?.data||null:(p.delete(s),null),v=(s,a,t=P)=>{p.set(s,{data:a,timestamp:Date.now(),ttl:t})},c={getSummary:async s=>{const a=w("summary",s),t=C(a);if(t)return console.log("ðŸ“Š Using cached trademark summary data"),t;try{console.log("ðŸ”„ Fetching trademark summary...");const n={data:(await m.get("/summary",{params:s})).data};return v(a,n),n}catch(r){throw console.error("âŒ Error fetching trademark summary:",r),r}},getTopClasses:async s=>{const a=w("topClasses",s),t=C(a);if(t)return console.log("ðŸ“Š Using cached trademark classes data"),t;try{console.log("ðŸ”„ Fetching top trademark classes...");const r=await m.get("/classes/top",{params:s}),n={data:Array.isArray(r.data)?r.data:[]};return v(a,n),n}catch(r){throw console.error("âŒ Error fetching trademark classes:",r),r}},getTopCountries:async s=>{const a=w("topCountries",s),t=C(a);if(t)return console.log("ðŸ“Š Using cached trademark countries data"),t;try{console.log("ðŸ”„ Fetching top trademark countries...");const r=await m.get("/countries/top",{params:s}),n={data:Array.isArray(r.data)?r.data:[]};return v(a,n),n}catch(r){throw console.error("âŒ Error fetching trademark countries:",r),r}},getStatusDistribution:async s=>{const a=w("statusDistribution",s),t=C(a);if(t)return console.log("ðŸ“Š Using cached trademark status data"),t;try{console.log("ðŸ”„ Fetching trademark status distribution...");const r=await m.get("/status",{params:s}),n={data:Array.isArray(r.data)?r.data:[]};return v(a,n),n}catch(r){throw console.error("âŒ Error fetching trademark status:",r),r}},getAllTrendData:async s=>{try{console.log("ðŸ”„ Aggregating all trademark trend data...");const[a,t,r,n]=await Promise.all([c.getSummary(s),c.getTopClasses(s),c.getTopCountries(s),c.getStatusDistribution(s)]),o={summary:a.data,topClasses:t.data,topCountries:r.data,statusDistribution:n.data,timestamp:new Date().toISOString()};return console.log("âœ… Successfully aggregated trademark trend data"),o}catch(a){throw console.error("âŒ Error aggregating trademark trend data:",a),a}},clearCache:()=>{p.clear(),console.log("ðŸ§¹ Trademark trend cache cleared")}},R=[{id:"summary",title:"Summary Metrics",icon:"ðŸ“Š",description:"Total applications, filings by year, recent activity",fetchFunction:()=>c.getSummary().then(s=>s.data)},{id:"top-classes",title:"Top Classes",icon:"ðŸ·ï¸",description:"International classes with highest branding activity",fetchFunction:()=>c.getTopClasses().then(s=>s.data)},{id:"top-countries",title:"Top Countries",icon:"ðŸŒ",description:"Geographic distribution of trademark ownership",fetchFunction:()=>c.getTopCountries().then(s=>s.data)},{id:"status-distribution",title:"Status Distribution",icon:"âœ…",description:"Brand lifecycle: LIVE, DEAD, and other statuses",fetchFunction:()=>c.getStatusDistribution().then(s=>s.data)}],B=({card:s,isActive:a,isLoading:t,hasError:r,onClick:n})=>e.jsx(x,{onClick:n,className:`cursor-pointer transition-all duration-200 hover:shadow-lg hover:scale-105 ${a?"ring-2 ring-blue-500 bg-blue-50":""} ${r?"ring-2 ring-red-500 bg-red-50":""}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("span",{className:"text-4xl",children:s.icon}),t&&e.jsx(A,{className:"h-5 w-5 animate-spin text-blue-500"}),r&&e.jsx("span",{className:"text-red-500 text-lg",children:"âš ï¸"})]}),e.jsx("h3",{className:"font-semibold text-lg text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),t&&e.jsx("div",{className:"mt-4 text-xs text-blue-600 font-medium",children:"Loading..."}),r&&e.jsx("div",{className:"mt-4 text-xs text-red-600 font-medium",children:"Error loading data"})]})}),$={"001":"Chemicals & Pharmaceuticals","002":"Paints & Coatings","003":"Cleaning & Personal Care Products","004":"Industrial Oils & Waxes","005":"Pharmaceuticals & Medical Preparations","006":"Common Metals & Metal Products","007":"Machinery & Equipment","008":"Hand Tools & Implements","009":"Electrical & Scientific Apparatus","010":"Medical & Surgical Instruments","011":"Environmental Control Apparatus","012":"Vehicles & Transportation","013":"Firearms & Ammunition","014":"Jewelry & Precious Metals","015":"Musical Instruments","016":"Paper Goods & Office Supplies","017":"Rubber & Plastic Materials","018":"Leather & Leather Goods","019":"Non-Metallic Building Materials","020":"Furniture & Fixtures","021":"Household Utensils & Containers","022":"Rope, Cord & Textile Fibers","023":"Yarns & Threads","024":"Textiles & Fabric","025":"Clothing & Footwear","026":"Lace, Braid & Trimmings","027":"Carpets & Rugs","028":"Sports & Recreation Equipment","029":"Meat & Food Products","030":"Flour, Cereals & Prepared Foods","031":"Agricultural Products & Seeds","032":"Beer, Non-Alcoholic Beverages","033":"Alcoholic Beverages","034":"Tobacco & Smoking Supplies","035":"Advertising & Business Services","036":"Insurance & Financial Services","037":"Building & Construction Services","038":"Telecommunications Services","039":"Transportation & Storage Services","040":"Material Processing & Treatment","041":"Education & Training Services","042":"Computer & Scientific Services","043":"Food & Beverage Service","044":"Medical & Veterinary Services","045":"Legal & Security Services"},U=s=>$[s]||`Class ${s}`,O=({cardId:s,title:a,data:t,loading:r,error:n,onClose:o})=>n?e.jsxs(x,{className:"border-red-200 bg-red-50",children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(f,{className:"text-red-900",children:a}),e.jsx(g,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:e.jsx(N,{className:"h-4 w-4"})})]}),e.jsx(b,{children:e.jsxs(k,{className:"bg-red-100 border-red-300",children:[e.jsx(T,{className:"h-4 w-4 text-red-600"}),e.jsx(S,{className:"text-red-700",children:n.message||"Failed to load trademark data"})]})})]}):r?e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(f,{children:a}),e.jsx(g,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:e.jsx(N,{className:"h-4 w-4"})})]}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(A,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsxs("span",{className:"ml-2 text-gray-600",children:["Loading ",a,"..."]})]})})]}):t?e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsxs("div",{children:[e.jsx(f,{children:a}),e.jsx(F,{children:"Detailed trademark analysis"})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:e.jsx(N,{className:"h-4 w-4"})})]}),e.jsxs(b,{children:[s==="summary"&&e.jsx(V,{data:t}),s==="top-classes"&&e.jsx(z,{data:t}),s==="top-countries"&&e.jsx(_,{data:t}),s==="status-distribution"&&e.jsx(H,{data:t})]})]}):e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(f,{children:a}),e.jsx(g,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:e.jsx(N,{className:"h-4 w-4"})})]}),e.jsx(b,{children:e.jsxs(k,{children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx(S,{children:"No data available"})]})})]}),V=({data:s})=>!s||typeof s!="object"?e.jsx("div",{className:"text-gray-600",children:"No summary data"}):e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(s).map(([a,t])=>e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:a.replace(/([A-Z])/g," $1")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:typeof t=="object"?JSON.stringify(t):String(t)})]},a))})}),z=({data:s})=>{if(!Array.isArray(s)||s.length===0)return e.jsx("div",{className:"text-gray-600",children:"No class data"});const a=Math.max(...s.map(t=>t.count))*1.1;return e.jsx("div",{className:"space-y-4",children:s.map(t=>{const r=t.count/a*100,n=U(t.code);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.code}),e.jsx("p",{className:"text-sm text-gray-600",children:n})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.count.toLocaleString()}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.percentage.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]},t.code)})})},_=({data:s})=>{if(!Array.isArray(s)||s.length===0)return e.jsx("div",{className:"text-gray-600",children:"No country data"});const a=Math.max(...s.map(t=>t.count))*1.1;return e.jsx("div",{className:"space-y-4",children:s.map(t=>{const r=t.count/a*100;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.label}),e.jsx("p",{className:"font-semibold text-gray-900",children:t.count.toLocaleString()})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]},t.label)})})},H=({data:s})=>{if(!Array.isArray(s)||s.length===0)return e.jsx("div",{className:"text-gray-600",children:"No status data"});const a=s.reduce((r,n)=>r+n.count,0),t=r=>r==="LIVE"?"bg-green-500":r==="DEAD"?"bg-red-500":"bg-gray-500";return e.jsx("div",{className:"space-y-4",children:s.map(r=>{const n=r.count/a*100,o=t(r.label);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:r.label}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:r.count.toLocaleString()}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`${o} h-3 rounded-full transition-all duration-300`,style:{width:`${n}%`}})})]},r.label)})})},J=()=>{const[s,a]=h.useState(null),[t,r]=h.useState({}),n=h.useCallback(async i=>{if(t[i.id]?.data&&!t[i.id]?.loading){a({cardId:i.id,title:i.title,data:t[i.id].data,loading:!1,error:t[i.id].error});return}r(l=>({...l,[i.id]:{loading:!0,error:null,data:null}})),a({cardId:i.id,title:i.title,data:null,loading:!0,error:null});try{const l=await i.fetchFunction();console.debug(`[TrademarkDashboard] Fetched data for ${i.id}:`,l),r(d=>({...d,[i.id]:{loading:!1,error:null,data:l}})),a({cardId:i.id,title:i.title,data:l,loading:!1,error:null})}catch(l){const d=l instanceof Error?l:new Error("Unknown error");console.error(`[TrademarkDashboard] Error fetching ${i.id}:`,d),r(j=>({...j,[i.id]:{loading:!1,error:d,data:null}})),a({cardId:i.id,title:i.title,data:null,loading:!1,error:d})}},[t]),o=h.useCallback(()=>{if(!s?.data)return;const i={cardId:s.cardId,title:s.title,data:s.data,exportedAt:new Date().toISOString()},l=JSON.stringify(i,null,2),d=new Blob([l],{type:"application/json"}),j=URL.createObjectURL(d),u=document.createElement("a");u.href=j,u.download=`trademark-${s.cardId}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(j)},[s]),D=h.useCallback(()=>{a(null)},[]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Trademark Trend Analysis"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Click any card to explore detailed trademark trends. Data loads on-demand for optimal performance."})]}),e.jsx("div",{className:"flex items-center gap-2",children:s?.data&&e.jsxs(g,{variant:"outline",size:"sm",onClick:o,className:"gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Export"]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:R.map(i=>e.jsx(B,{card:i,isActive:s?.cardId===i.id,isLoading:t[i.id]?.loading||!1,hasError:!!t[i.id]?.error,onClick:()=>n(i)},i.id))}),s&&e.jsx("div",{className:"mb-8",children:e.jsx(O,{cardId:s.cardId,title:s.title,data:s.data,loading:s.loading,error:s.error,onClose:D})})]})})};function ee(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsx(J,{})})}export{ee as default};
