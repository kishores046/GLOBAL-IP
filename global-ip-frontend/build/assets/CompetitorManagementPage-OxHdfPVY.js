import{u as B,r as d,j as e}from"./index-BbdKGyFO.js";import{S as H}from"./Sidebar-i27tk-Tt.js";import{D as U}from"./DashboardHeader-CK3555d_.js";import{u as z,B as S,c as v}from"./useCompetitors-DMZRCXTv.js";import{P as w}from"./plus-0Nqk-eqM.js";import{S as K}from"./search-BeavGINr.js";import{S as Q}from"./square-pen-btLjqzLW.js";import{T as R}from"./trash-2-BS5v2fAb.js";import{X as g}from"./x-BD8jR-FZ.js";import{S as A}from"./save-DAcsyfLT.js";import"./users-D5aJHt4s.js";import"./chart-column-ulK0xHEq.js";import"./file-text-CZhUgEQo.js";import"./download-5qXpfTS0.js";import"./chevron-down-CAl0sHJA.js";import"./globe-CjcR3HKJ.js";function re(){B();const{competitors:E,isLoading:D,refetch:f}=z(!1),[m,L]=d.useState(""),[P,u]=d.useState(!1),[b,p]=d.useState(null),[i,c]=d.useState(!1),[a,o]=d.useState({code:"",displayName:"",assigneeNames:[],description:"",industry:""}),[l,n]=d.useState({displayName:"",assigneeNames:[],active:!0,description:"",industry:""}),[x,N]=d.useState(""),C=E.filter(s=>s.displayName.toLowerCase().includes(m.toLowerCase())||s.code.toLowerCase().includes(m.toLowerCase())||s.industry?.toLowerCase().includes(m.toLowerCase())),F=async()=>{try{c(!0),await v.createCompetitor(a),u(!1),o({code:"",displayName:"",assigneeNames:[],description:"",industry:""}),f()}catch(s){console.error("Error creating competitor:",s),alert("Failed to create competitor")}finally{c(!1)}},I=async()=>{if(b)try{c(!0),await v.updateCompetitor(b.id,l),p(null),f()}catch(s){console.error("Error updating competitor:",s),alert("Failed to update competitor")}finally{c(!1)}},M=async(s,t)=>{if(confirm(`Are you sure you want to delete ${t}?`))try{c(!0),await v.deleteCompetitor(s),await f()}catch(r){console.error("Error deleting competitor:",r);const j=r instanceof Error?r.message:"Failed to delete competitor";alert(j)}finally{c(!1)}},T=s=>{p(s),n({displayName:s.displayName,assigneeNames:s.assigneeNames,active:s.active,description:s.description||"",industry:s.industry||""})},h=s=>{x.trim()&&(s==="create"?o(t=>({...t,assigneeNames:[...t.assigneeNames,x.trim()]})):n(t=>({...t,assigneeNames:[...t.assigneeNames||[],x.trim()]})),N(""))},k=(s,t)=>{t==="create"?o(r=>({...r,assigneeNames:r.assigneeNames.filter((j,y)=>y!==s)})):n(r=>({...r,assigneeNames:(r.assigneeNames||[]).filter((j,y)=>y!==s)}))};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100",children:[e.jsx(U,{userName:"Admin"}),e.jsxs("div",{className:"flex",children:[e.jsx(H,{}),e.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(S,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-4xl font-bold text-blue-900",children:"Competitor Management"})]}),e.jsx("p",{className:"text-slate-600",children:"Manage tracked competitors and their assignee names"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-md",children:[e.jsx(w,{className:"w-5 h-5"}),"Add Competitor"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search competitors...",value:m,onChange:s=>L(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-md border border-slate-200",children:D?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading competitors..."})]}):C.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(S,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"No competitors found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-slate-200 bg-slate-50",children:[e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Code"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Name"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Industry"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Assignees"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Status"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Total Filings"}),e.jsx("th",{className:"text-right py-4 px-6 text-sm font-semibold text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{children:C.map(s=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"py-4 px-6 text-sm font-mono text-blue-600 font-medium",children:s.code}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-900 font-medium",children:s.displayName}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-600",children:s.industry||"N/A"}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-600",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.assigneeNames.slice(0,2).map((t,r)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:t},r)),s.assigneeNames.length>2&&e.jsxs("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs",children:["+",s.assigneeNames.length-2," more"]})]})}),e.jsx("td",{className:"py-4 px-6 text-sm",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.active?"Active":"Inactive"})}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-600",children:s.totalFilings?.toLocaleString()||"0"}),e.jsxs("td",{className:"py-4 px-6 text-sm text-right",children:[e.jsx("button",{onClick:()=>T(s),disabled:i,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors mr-2 disabled:opacity-50 disabled:cursor-not-allowed",title:"Edit",children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>M(s.id,s.displayName),disabled:i,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete",children:e.jsx(R,{className:"w-4 h-4"})})]})]},s.id))})]})})})]})})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Add New Competitor"}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",style:{maxHeight:"calc(80vh - 180px)"},children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.code,onChange:s=>o({...a,code:s.target.value.toUpperCase()}),placeholder:"e.g., APPLE, SAMSUNG",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Display Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.displayName,onChange:s=>o({...a,displayName:s.target.value}),placeholder:"e.g., Apple Inc.",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Assignee Names ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:x,onChange:s=>N(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),h("create")),placeholder:"Add assignee name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{onClick:()=>h("create"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(w,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.assigneeNames.map((s,t)=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg flex items-center gap-2",children:[s,e.jsx("button",{onClick:()=>k(t,"create"),className:"hover:text-blue-900",children:e.jsx(g,{className:"w-4 h-4"})})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Industry"}),e.jsx("input",{type:"text",value:a.industry,onChange:s=>o({...a,industry:s.target.value}),placeholder:"e.g., Technology, Pharmaceuticals",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:s=>o({...a,description:s.target.value}),rows:3,placeholder:"Brief description of the competitor",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 flex gap-3 justify-end bg-white rounded-b-xl flex-shrink-0",children:[e.jsx("button",{onClick:()=>u(!1),disabled:i,className:"px-6 py-2.5 border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 transition-colors font-medium disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{onClick:F,disabled:i||!a.code||!a.displayName||a.assigneeNames.length===0,className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium shadow-lg",children:[e.jsx(A,{className:"w-5 h-5"}),i?"Creating...":"Create Competitor"]})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between flex-shrink-0",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Edit Competitor"}),e.jsx("button",{onClick:()=>p(null),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",style:{maxHeight:"calc(80vh - 180px)"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Code (Read-only)"}),e.jsx("input",{type:"text",value:b.code,disabled:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg bg-slate-50 text-slate-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Display Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l.displayName,onChange:s=>n({...l,displayName:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Assignee Names ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:x,onChange:s=>N(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),h("edit")),placeholder:"Add assignee name",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{onClick:()=>h("edit"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(w,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(l.assigneeNames||[]).map((s,t)=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg flex items-center gap-2",children:[s,e.jsx("button",{onClick:()=>k(t,"edit"),className:"hover:text-blue-900",children:e.jsx(g,{className:"w-4 h-4"})})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Industry"}),e.jsx("input",{type:"text",value:l.industry,onChange:s=>n({...l,industry:s.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:s=>n({...l,description:s.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.active,onChange:s=>n({...l,active:s.target.checked}),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Active"})]})})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 flex gap-3 justify-end bg-white rounded-b-xl flex-shrink-0",children:[e.jsx("button",{onClick:()=>p(null),disabled:i,className:"px-6 py-2.5 border border-slate-300 rounded-lg text-slate-700 hover:bg-slate-50 transition-colors font-medium disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{onClick:I,disabled:i||!l.displayName||(l.assigneeNames||[]).length===0,className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium shadow-lg",children:[e.jsx(A,{className:"w-5 h-5"}),i?"Saving...":"Save Changes"]})]})]})})]})}export{re as CompetitorManagementPage};
