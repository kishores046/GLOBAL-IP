import{r as c,j as e,b,t as l}from"./index-BbdKGyFO.js";import{r as x}from"./roleRequestService-DwTJaFzP.js";import{D as v}from"./DashboardHeader-CK3555d_.js";import{A as R}from"./AdminSidebar-CESQZ0uU.js";import{S as p}from"./shield-CoTmmyQ6.js";import{C as q}from"./circle-check-big-CAMtQ4aA.js";import{C as A}from"./circle-x-BojSLiMA.js";import{C}from"./clock-CVEhCKB6.js";import{R as f}from"./refresh-cw-Bm27OB5K.js";import"./users-D5aJHt4s.js";import"./chevron-down-CAl0sHJA.js";import"./globe-CjcR3HKJ.js";import"./activity-D1k2LaKT.js";import"./file-text-CZhUgEQo.js";function H(){const[o,m]=c.useState([]),[r,u]=c.useState(!0),[n,i]=c.useState(null),h=async()=>{u(!0);try{const s=await x.getPendingRequests();m(s)}catch(s){const t=s.response?.data?.message??"Failed to load pending requests";s.response?.status===403?l.error("Unauthorized: Admin access required"):l.error(t)}finally{u(!1)}};c.useEffect(()=>{h()},[]);const j=async s=>{i(s);try{const t=await x.approveRequest(s);l.success(t.message||"Request approved successfully"),m(a=>a.filter(d=>d.requestId!==s))}catch(t){const a=t.response?.data?.message??"Failed to approve request";t.response?.status===403?l.error("Unauthorized: Admin access required"):l.error(a)}finally{i(null)}},g=async s=>{i(s);try{const t=await x.rejectRequest(s);l.success(t.message||"Request rejected"),m(a=>a.filter(d=>d.requestId!==s))}catch(t){const a=t.response?.data?.message??"Failed to reject request";t.response?.status===403?l.error("Unauthorized: Admin access required"):l.error(a)}finally{i(null)}},N=async s=>{i(s);try{const t=await x.waitlistRequest(s);l.success(t.message||"Request added to waitlist"),m(a=>a.filter(d=>d.requestId!==s))}catch(t){const a=t.response?.data?.message??"Failed to waitlist request";t.response?.status===403?l.error("Unauthorized: Admin access required"):l.error(a)}finally{i(null)}},y=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),w=c.useMemo(()=>r?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading pending requests..."})]})}):o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(p,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-2",children:"No Pending Requests"}),e.jsx("p",{className:"text-slate-500 text-center max-w-md",children:"There are currently no pending role requests to review. New requests will appear here automatically."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Request ID"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Username"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Email"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Requested Role"}),e.jsx("th",{className:"text-left py-4 px-6 text-sm font-semibold text-slate-700",children:"Requested At"}),e.jsx("th",{className:"text-center py-4 px-6 text-sm font-semibold text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:o.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("code",{className:"text-xs bg-slate-100 px-2 py-1 rounded text-slate-700 font-mono",children:["#",s.requestId]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-700 font-semibold text-sm",children:s.username.charAt(0).toUpperCase()})}),e.jsx("span",{className:"font-medium text-slate-900",children:s.username})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:"text-slate-700",children:s.email})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-purple-50 text-purple-700 rounded-full text-sm font-medium",children:[e.jsx(p,{className:"w-3.5 h-3.5"}),s.requestedRole.replace("ROLE_","")]})}),e.jsx("td",{className:"py-4 px-6 text-sm text-slate-600",children:y(s.requestedAt)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>j(s.requestId),disabled:n===s.requestId,className:"flex items-center gap-1.5 px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm",title:"Approve",children:[n===s.requestId?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(q,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>g(s.requestId),disabled:n===s.requestId,className:"flex items-center gap-1.5 px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm",title:"Reject",children:[e.jsx(A,{className:"w-4 h-4"}),"Reject"]}),e.jsxs("button",{onClick:()=>N(s.requestId),disabled:n===s.requestId,className:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-600 hover:bg-amber-700 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm",title:"Waitlist",children:[e.jsx(C,{className:"w-4 h-4"}),"Waitlist"]})]})})]},s.requestId))})]})}),[r,o,n]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100",children:[e.jsx(v,{userName:"Admin"}),e.jsxs("div",{className:"flex",children:[e.jsx(R,{}),e.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl text-blue-900 mb-2",children:"Role-Based Access Control"}),e.jsx("p",{className:"text-slate-600",children:"Review and manage pending admin access requests"})]}),e.jsxs("button",{onClick:h,disabled:r,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg flex items-center gap-2 transition-all shadow-lg disabled:opacity-50",children:[e.jsx(f,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-6 border border-blue-200/50 hover:border-blue-300/50 transition-all shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-md",children:e.jsx(p,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-900",children:"Role Requests"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Review and manage pending admin access requests"})]})]}),e.jsxs("button",{onClick:h,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all disabled:opacity-50",children:[e.jsx(f,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-xl overflow-hidden",children:w}),o.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-slate-700",children:[e.jsx("strong",{children:"Note:"})," Approving a request will grant the user admin privileges immediately. Rejected requests will be removed from this list. Waitlisted requests can be reviewed later."]})})]})})]})]})}export{H as AdminRoleRequestsPage};
