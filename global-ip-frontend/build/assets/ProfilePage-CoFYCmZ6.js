import{e as b,u as z,a as I,r as n,j as e,b as M,c as x,t as h}from"./index-BbdKGyFO.js";import{D as P}from"./DashboardHeader-CK3555d_.js";import{S}from"./Sidebar-i27tk-Tt.js";import{P as T}from"./pen-DEyIFQiA.js";import{S as F}from"./save-DAcsyfLT.js";import{X as _}from"./x-BD8jR-FZ.js";import{M as q}from"./mail-Cz_G6s0G.js";import{M as k}from"./map-pin-CW1mFAl4.js";import"./users-D5aJHt4s.js";import"./chevron-down-CAl0sHJA.js";import"./globe-CjcR3HKJ.js";import"./search-BeavGINr.js";import"./chart-column-ulK0xHEq.js";import"./file-text-CZhUgEQo.js";import"./download-5qXpfTS0.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],D=b("briefcase",B);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],H=b("camera",G);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],U=b("phone",V);function re(){const f=z(),{user:u}=I(),[C,m]=n.useState(!0),[r,p]=n.useState(!1),g=n.useRef(!1),[l,j]=n.useState({username:"",email:"",role:"",phone:"",location:"",company:"",position:"",joinDate:"",bio:"",specialization:""}),[t,c]=n.useState(l),[N,v]=n.useState(null);n.useEffect(()=>{if(g.current){console.log("[ProfilePage] Already loaded, skipping...");return}(async()=>{try{m(!0),console.log("[ProfilePage] Loading user profile...");const s=await x.getUserProfile();console.log("[ProfilePage] User data received:",s);const o=s?.roles?.[0],d=typeof o=="string"?o:o?.roleType||"USER";console.log("[ProfilePage] Primary role:",d),j({username:s.username||"",email:s.email||"",role:d,phone:s.phoneNumber??"",location:s.location??"",company:s.company??"",position:s.position??"",joinDate:s.joinDate??new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),bio:s.bio??"",specialization:""}),c({username:s.username||"",email:s.email||"",role:d,phone:s.phoneNumber??"",location:s.location??"",company:s.company??"",position:s.position??"",joinDate:s.joinDate??new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),bio:s.bio??"",specialization:""}),s.profileImage&&v(s.profileImage),g.current=!0,console.log("[ProfilePage] Profile loaded successfully")}catch(s){console.error("Failed to load user profile:",s),h.error("Failed to load profile data"),x.isAuthenticated()||f("/login")}finally{m(!1)}})()},[f]);const E=()=>{p(!0),c(l)},R=async()=>{try{m(!0),console.log("[ProfilePage] Saving profile data:",t);const a=await x.updateUserProfile({username:t.username,phoneNumber:t.phone,location:t.location,company:t.company,position:t.position,bio:t.bio});console.log("[ProfilePage] Profile updated successfully:",a);const s=await x.getUserProfile();console.log("[ProfilePage] Fetched complete profile:",s);const o=s?.roles?.[0],d=typeof o=="string"?o:o?.roleType||"USER",w={username:s.username||"",email:s.email||"",role:d,phone:s.phoneNumber??"",location:s.location??"",company:s.company??"",position:s.position??"",joinDate:l.joinDate,bio:s.bio??"",specialization:""};j(w),c(w),p(!1),h.success("Profile updated successfully!")}catch(a){console.error("Failed to update profile:",a),h.error(a instanceof Error?a.message:"Failed to update profile")}finally{m(!1)}},A=()=>{c(l),p(!1)},L=a=>{const s=a.target.files?.[0];if(s){const o=new FileReader;o.onloadend=()=>{v(o.result)},o.readAsDataURL(s)}},i=(a,s)=>{c(o=>({...o,[a]:s}))},y=a=>{switch(a?.toUpperCase()){case"ADMIN":return"Administrator";case"ANALYST":return"Senior Analyst";case"USER":default:return"User"}};return C?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100",children:[e.jsx(P,{userName:"User"}),e.jsxs("div",{className:"flex",children:[e.jsx(S,{}),e.jsx("main",{className:"flex-1 p-8 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading profile..."})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100",children:[e.jsx(P,{userName:l.username||"User"}),e.jsxs("div",{className:"flex",children:[e.jsx(S,{}),e.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl text-blue-900 mb-2",children:"My Profile"}),e.jsx("p",{className:"text-slate-600",children:"Manage your personal information"})]}),e.jsx("div",{className:"flex gap-3",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all",children:[e.jsx(F,{className:"w-5 h-5"}),"Save Changes"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-6 py-3 bg-slate-400 hover:bg-slate-500 text-white rounded-lg shadow-md transition-all",children:[e.jsx(_,{className:"w-5 h-5"}),"Cancel"]})]}):e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all",children:[e.jsx(T,{className:"w-5 h-5"}),"Edit Profile"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-md p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-40 h-40 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center border-4 border-white shadow-lg overflow-hidden",children:N?e.jsx("img",{src:N,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-6xl text-white font-bold",children:(l.username||l.email||"U").charAt(0).toUpperCase()})}),r&&e.jsxs("label",{className:"absolute bottom-2 right-2 w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center cursor-pointer shadow-lg hover:bg-blue-700 transition-colors",children:[e.jsx(H,{className:"w-5 h-5 text-white"}),e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:"hidden"})]})]}),e.jsx("h2",{className:"mt-4 text-2xl font-semibold text-blue-900 text-center",children:l.username}),e.jsx("p",{className:"text-slate-600 mt-1",children:y(l.role)}),e.jsx("div",{className:"mt-3 px-4 py-2 bg-blue-50 rounded-full border border-blue-200",children:e.jsxs("span",{className:"text-sm text-blue-700",children:["Member since ",l.joinDate]})})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-900 mb-4",children:"Activity Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-700",children:"Tracked Patents"}),e.jsx("span",{className:"text-2xl font-semibold text-blue-600",children:u?.trackedPatents||"0"})]}),e.jsx("div",{className:"h-px bg-slate-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-700",children:"Tracked Trademarks"}),e.jsx("span",{className:"text-2xl font-semibold text-blue-600",children:u?.trackedTrademarks||"0"})]}),e.jsx("div",{className:"h-px bg-slate-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-700",children:"Reports Generated"}),e.jsx("span",{className:"text-2xl font-semibold text-blue-600",children:u?.reportsGenerated||"0"})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-blue-900 mb-6",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Username"}),r?e.jsx("input",{type:"text",value:t.username,onChange:a=>i("username",a.target.value),className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"}):e.jsx("div",{className:"px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:e.jsx("span",{className:"text-slate-900",children:l.username})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx(q,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-slate-900",children:l.email})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Phone Number"}),r?e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"tel",value:t.phone,onChange:a=>i("phone",a.target.value),placeholder:"Enter phone number",className:"w-full pl-12 pr-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"})]}):e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx(U,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-slate-900",children:l.phone||"Not provided"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Location"}),r?e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:t.location,onChange:a=>i("location",a.target.value),placeholder:"Enter location",className:"w-full pl-12 pr-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"})]}):e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx(k,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-slate-900",children:l.location||"Not provided"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Role"}),e.jsx("div",{className:"px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:e.jsx("span",{className:"text-slate-900 font-medium",children:y(l.role)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Role is assigned by administrators"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-blue-900 mb-6",children:"Professional Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Company"}),r?e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:t.company,onChange:a=>i("company",a.target.value),placeholder:"Enter company name",className:"w-full pl-12 pr-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"})]}):e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx(D,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"text-slate-900",children:l.company||"Not provided"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Position"}),r?e.jsx("input",{type:"text",value:t.position,onChange:a=>i("position",a.target.value),placeholder:"Enter position",className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"}):e.jsx("div",{className:"px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:e.jsx("span",{className:"text-slate-900",children:l.position||"Not provided"})})]}),l.role?.toUpperCase()==="ANALYST"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-slate-700 font-medium mb-2",children:"Specialization"}),r?e.jsx("input",{type:"text",value:t.specialization,onChange:a=>i("specialization",a.target.value),placeholder:"Enter your specialization",className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"}):e.jsx("div",{className:"px-4 py-3 bg-slate-50 rounded-lg border border-slate-200",children:e.jsx("span",{className:"text-slate-900",children:l.specialization||"Not provided"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-blue-900 mb-6",children:"Bio"}),r?e.jsx("textarea",{value:t.bio,onChange:a=>i("bio",a.target.value),rows:4,placeholder:"Tell us about yourself...",className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all resize-none"}):e.jsx("p",{className:"text-slate-700 leading-relaxed",children:l.bio||"No bio provided yet. Click 'Edit Profile' to add one."})]})]})]})]})})]})]})}export{re as ProfilePage};
